<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Max Lindmark">
<meta name="dcterms.date" content="2023-05-02">

<title>Make the prediction grid</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="03_make_pred_grid_files/libs/clipboard/clipboard.min.js"></script>
<script src="03_make_pred_grid_files/libs/quarto-html/quarto.js"></script>
<script src="03_make_pred_grid_files/libs/quarto-html/popper.min.js"></script>
<script src="03_make_pred_grid_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="03_make_pred_grid_files/libs/quarto-html/anchor.min.js"></script>
<link href="03_make_pred_grid_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="03_make_pred_grid_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="03_make_pred_grid_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="03_make_pred_grid_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="03_make_pred_grid_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Make the prediction grid</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Max Lindmark </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 2, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="intro" class="level1">
<h1>Intro</h1>
<p>Make an evenly spaced UTM prediction grid with all spatially varying covariates for the diet and the biomass data</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries, install if needed</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidylog)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RCurl)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sdmTMB)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ncdf4)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(chron)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Source code for map plots</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">source_url</span>(<span class="st">"https://raw.githubusercontent.com/maxlindmark/cod-interactions/main/R/functions/map-plot.R"</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Source code for lon lat to utm</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">source_url</span>(<span class="st">"https://raw.githubusercontent.com/maxlindmark/cod-interactions/main/R/functions/lon-lat-utm.R"</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_plot</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Read data and depth-raster</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/maxlindmark/pred-prey-overlap/main/data/clean/catch_clean.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">X =</span> x, <span class="at">Y =</span> y)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rows: 9373 Columns: 21</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ── Column specification ────────────────────────────────────────────────────────</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Delimiter: ","</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; chr  (6): country, haul_id, ices_rect, species, month_year, substrate</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dbl (14): year, lat, lon, quarter, month, sub_div, oxy, temp, sal, depth, x,...</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lgl  (1): id_haul_stomach</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rename: renamed 2 variables (X, Y)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="make-the-grid-with-depth" class="level2">
<h2 class="anchored" data-anchor-id="make-the-grid-with-depth">Make the grid with depth</h2>
<p>First make a grid for the biomass data, then subset that based on the extend of the stomach data</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> d<span class="sc">$</span>X</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> d<span class="sc">$</span>Y</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">chull</span>(x, y)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x[z], y[z])</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">rbind</span>(coords, coords[<span class="dv">1</span>, ])</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(coords[, <span class="dv">1</span>] <span class="sc">~</span> coords[, <span class="dv">2</span>]) <span class="co"># plot data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/make%20pred%20grid-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>sp_poly <span class="ot">&lt;-</span> sp<span class="sc">::</span><span class="fu">SpatialPolygons</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(sp<span class="sc">::</span><span class="fu">Polygons</span>(<span class="fu">list</span>(sp<span class="sc">::</span><span class="fu">Polygon</span>(coords)), <span class="at">ID =</span> <span class="dv">1</span>))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>sp_poly_df <span class="ot">&lt;-</span> sp<span class="sc">::</span><span class="fu">SpatialPolygonsDataFrame</span>(sp_poly,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">ID =</span> <span class="dv">1</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                                           )</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>cell_width <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>pred_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="fu">min</span>(d<span class="sc">$</span>X), <span class="fu">max</span>(d<span class="sc">$</span>X), cell_width),</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> <span class="fu">seq</span>(<span class="fu">min</span>(d<span class="sc">$</span>Y), <span class="fu">max</span>(d<span class="sc">$</span>Y), cell_width),</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="fu">unique</span>(d<span class="sc">$</span>year)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_grid <span class="sc">|&gt;</span> <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2019</span>), <span class="fu">aes</span>(X, Y)) <span class="sc">+</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>()</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; filter: removed 850,905 rows (96%), 31,515 rows remaining</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/make%20pred%20grid-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>sp<span class="sc">::</span><span class="fu">coordinates</span>(pred_grid) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"X"</span>, <span class="st">"Y"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>inside <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">is.na</span>(sp<span class="sc">::</span><span class="fu">over</span>(pred_grid, <span class="fu">as</span>(sp_poly_df, <span class="st">"SpatialPolygons"</span>)))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>pred_grid <span class="ot">&lt;-</span> pred_grid[inside, ]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>pred_grid <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred_grid)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">filter</span>(pred_grid, year <span class="sc">==</span> <span class="dv">1999</span>), <span class="fu">aes</span>(X<span class="sc">*</span><span class="dv">1000</span>, Y<span class="sc">*</span><span class="dv">1000</span>)) <span class="sc">+</span> </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.001</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; filter: removed 512,784 rows (96%), 18,992 rows remaining</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/make%20pred%20grid-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>plot_map <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">filter</span>(pred_grid, year <span class="sc">==</span> <span class="dv">1999</span>), <span class="fu">aes</span>(X<span class="sc">*</span><span class="dv">1000</span>, Y<span class="sc">*</span><span class="dv">1000</span>), <span class="at">size =</span> <span class="fl">0.001</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; filter: removed 512,784 rows (96%), 18,992 rows remaining</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 704 rows containing missing values (`geom_point()`).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/make%20pred%20grid-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Add lat and lon</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Need to go from UTM to lat long for this one...</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stackoverflow.com/questions/30018098/how-to-convert-utm-coordinates-to-lat-and-long-in-r</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(pred_grid <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(X, Y) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">X =</span> X<span class="sc">*</span><span class="dv">1000</span>, <span class="at">Y =</span> Y<span class="sc">*</span><span class="dv">1000</span>))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mutate: changed 531,776 values (100%) of 'X' (0 new NA)</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         changed 531,776 values (100%) of 'Y' (0 new NA)</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">vect</span>(xy, <span class="at">crs=</span><span class="st">"+proj=utm +zone=33 +datum=WGS84  +units=m"</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">project</span>(v, <span class="st">"+proj=longlat +datum=WGS84"</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>lonlat <span class="ot">&lt;-</span> <span class="fu">geom</span>(y)[, <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>)]</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>pred_grid<span class="sc">$</span>lon <span class="ot">&lt;-</span> lonlat[, <span class="dv">1</span>]</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>pred_grid<span class="sc">$</span>lat <span class="ot">&lt;-</span> lonlat[, <span class="dv">2</span>]</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">filter</span>(pred_grid, year <span class="sc">==</span> <span class="dv">1999</span>), <span class="fu">aes</span>(lon, lat)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; filter: removed 512,784 rows (96%), 18,992 rows remaining</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/make%20pred%20grid-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Add depth now to remove islands and remaining land</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># https://gis.stackexchange.com/questions/411261/read-multiple-layers-raster-from-ncdf-file-using-terra-package</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># https://emodnet.ec.europa.eu/geoviewer/</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>dep_raster <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="st">"data/Mean depth natural colour (with land).nc"</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(dep_raster)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] "SpatRaster"</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,"package")</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] "terra"</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="fu">crs</span>(dep_raster, <span class="at">proj =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] "+proj=longlat +datum=WGS84 +no_defs"</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dep_raster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/make%20pred%20grid-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>pred_grid<span class="sc">$</span>depth <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">extract</span>(dep_raster, pred_grid <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(lon, lat))<span class="sc">$</span>elevation</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_grid, <span class="fu">aes</span>(lon, lat, <span class="at">color =</span> depth<span class="sc">*-</span><span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/make%20pred%20grid-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>pred_grid<span class="sc">$</span>depth <span class="ot">&lt;-</span> pred_grid<span class="sc">$</span>depth<span class="sc">*-</span><span class="dv">1</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>pred_grid <span class="ot">&lt;-</span> pred_grid <span class="sc">|&gt;</span> <span class="fu">drop_na</span>(depth)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; drop_na: removed 74,340 rows (14%), 457,436 rows remaining</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>pred_grid <span class="sc">|&gt;</span> </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">1999</span>) <span class="sc">|&gt;</span> </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(depth) <span class="sc">|&gt;</span> </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(water = ifelse(depth &lt; 0.00000001, "N", "Y")) |&gt; </span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(X<span class="sc">*</span><span class="dv">1000</span>, Y<span class="sc">*</span><span class="dv">1000</span>, <span class="at">fill =</span> depth)) <span class="sc">+</span> </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>() <span class="sc">+</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; filter: removed 441,099 rows (96%), 16,337 rows remaining</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; drop_na: no rows removed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/make%20pred%20grid-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>plot_map <span class="sc">+</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> pred_grid, <span class="fu">aes</span>(X<span class="sc">*</span><span class="dv">1000</span>, Y<span class="sc">*</span><span class="dv">1000</span>), <span class="at">size =</span> <span class="fl">0.001</span>) <span class="sc">+</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>()</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 19628 rows containing missing values (`geom_point()`).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/make%20pred%20grid-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>plot_map <span class="sc">+</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="at">data =</span> <span class="fu">filter</span>(pred_grid, year <span class="sc">==</span> <span class="dv">1999</span>), <span class="fu">aes</span>(X<span class="sc">*</span><span class="dv">1000</span>, Y<span class="sc">*</span><span class="dv">1000</span>, <span class="at">fill =</span> depth), <span class="at">size =</span> <span class="fl">0.001</span>) <span class="sc">+</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>()</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; filter: removed 441,099 rows (96%), 16,337 rows remaining</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in geom_raster(data = filter(pred_grid, year == 1999), aes(X * 1000, :</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Ignoring unknown parameters: `size`</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 762 rows containing missing values (`geom_raster()`).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/make%20pred%20grid-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="substrate" class="level3">
<h3 class="anchored" data-anchor-id="substrate">Substrate</h3>
<p>First add lat and lon based on X and Y (utm)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>substrate <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="st">"data/substrate_tif/BALANCE_SEABED_SEDIMENT.tif"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>newcrs <span class="ot">&lt;-</span> <span class="st">"+proj=longlat +datum=WGS84"</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>substrate_longlat <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">project</span>(substrate, newcrs)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="sc">|---------</span><span class="er">|</span><span class="sc">---------</span><span class="er">|</span><span class="sc">---------</span><span class="er">|</span><span class="sc">---------</span><span class="er">|</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="er">=========================================</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                                          </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(substrate_longlat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Now extract the values from the saduria raster to pred_grid</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>pred_grid<span class="sc">$</span>substrate <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">extract</span>(substrate_longlat, pred_grid <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(lon, lat))<span class="sc">$</span>BALANCE_SEABED_SEDIMENT</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(pred_grid<span class="sc">$</span>substrate)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   [1] 3.000000 3.000000 2.207703 3.000000 2.000000 5.000000 2.751267 2.411566</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   [9]       NA 3.023438 3.832672 4.694020 4.816533 2.407304 2.675363 5.000000</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [17] 2.515299 2.105103 3.309344 2.215659 4.000000 2.418371 3.475584 3.136719</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [25] 3.112986 2.414551 4.865684 2.082964 3.555298 3.868274 3.925187 4.000000</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [33] 3.036916 4.963291 5.000000 2.703572 4.166504 3.295166 3.913452 2.989511</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [41] 2.172870 3.014659 3.177487 4.189331 4.184937 2.021204 3.047852 2.189819</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [49] 4.947398 2.084351 2.895818 4.771301 3.115845 2.466890 4.691040 2.189331</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [57] 2.446289 3.239708 3.565674 2.035608 4.346191 4.295288 2.221002 3.051758</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [65] 2.749512 3.481570 2.115028 2.060020 4.481857 3.367188 3.831543 1.000000</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [73] 4.013517 3.182683 2.004700 4.814331 2.606079 2.217144 1.983107 3.768187</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [81] 2.091238 3.106734 2.150879 3.954897 2.124500 3.680969 3.013173 3.388117</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [89] 2.451569 2.987671 3.004658 1.230957 3.087477 4.163172 4.331856 2.847656</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [97] 3.770158 3.125428 4.137214 3.885498 3.675112 4.481314 3.618304 3.535522</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [105] 4.465820 2.393921 3.985862 3.518553 2.930001 4.570422 3.035313 4.109073</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [113] 3.688112 3.070796 3.621094 2.000000 2.226810 3.092529 4.952732 4.725516</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [121] 3.052990 3.999512 4.006014 3.395804 3.495361 3.194580 2.990725 4.053308</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [129] 3.811279 4.897583 4.969238 3.747452 4.660645 4.250703 2.873901 2.834910</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [137] 2.995728 2.603516 4.352661 4.529053 2.199165 3.234210 4.856023 4.949766</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [145] 3.394407 3.105818 4.118896 2.052490 3.812706 2.458496 3.877447 4.508667</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [153] 4.997481 4.851562 3.038818 2.274684 2.144043 2.438833 3.721758 3.773949</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [161] 3.876709 4.547054 4.142808 3.771973 3.371582 4.526794 4.744454 2.290039</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [169] 2.186924 3.043457 3.958664 4.084717 2.060271 4.713074 4.014319 2.630802</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [177] 4.024494 4.889182 4.974456 3.012340 4.260180 4.845308 3.074554 4.409346</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [185] 3.289751 3.797133 4.741400 4.990298 4.992432 2.236906 4.020096 4.972815</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [193] 3.099850 3.104312 3.131250 4.014544 4.801950 3.626754 2.661298 4.347060</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [201] 3.388261 2.413086 3.486816 4.047920 4.273254 3.218567 4.880432 2.026447</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [209] 3.734937 3.617798 3.750732 3.903769 3.027101 4.973728 3.153159 4.907196</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [217] 4.142542 2.127837 3.366089 3.833514 3.686989 3.969054 2.451756 3.201677</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [225] 3.003133 3.956667 2.793945 3.498962 3.130925 3.051025 3.170776 3.023269</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [233] 2.039551 4.997342 3.213789 2.033046 2.056763 3.334717 2.716752 2.680646</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [241] 3.365524 4.719350 4.164907 3.439052 2.860320 4.233765 2.220443 3.163818</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [249] 4.547607 2.650146 3.881714 2.063853 2.738892 2.771362 3.844120 4.561007</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [257] 2.790509 3.166412 2.996045 3.074036 4.284657 3.897705 2.213809 2.750740</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [265] 3.372153 3.138924 4.034591 2.040606 3.311462 4.179138 2.755798 2.779163</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [273] 3.002139 2.831177 4.645380 4.891490 4.455089 3.114136 2.985872 4.142457</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [281] 4.969971 4.160156 2.700928 2.437500 3.261497 2.720737 2.674080 4.945340</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [289] 4.977245 4.981650 2.354534 3.050415 3.362427 4.034168 3.144043 3.427612</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [297] 3.115857 4.706665 4.172037 4.919150 4.779785 4.999610 3.258175 4.724830</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [305] 2.403870 2.568726 4.936082 4.244507 4.219971 4.019348 4.826586 3.978836</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [313] 4.504028 3.343665 4.380310 2.978498 4.912660 3.741167 3.936610 2.325832</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [321] 4.247200 2.162354 2.233486 2.387899 4.661255 3.199463 3.273992 2.430481</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [329] 2.529657 2.882263 3.927612 4.913927 2.105039 3.039957 3.861917 4.729696</span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [337] 3.608506 2.118599 2.201874 3.994565 2.977830 2.230170 3.841365 2.345047</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [345] 1.502260 3.117725 3.326439 4.573112 2.669355 4.844818 3.000978 2.726405</span></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [353] 3.340502 4.578941 4.333727 4.793458 1.626210 2.945679 3.053243 3.968300</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [361] 2.776123 1.726837 3.005692 3.789669 2.304810 3.019459 4.060608 2.094116</span></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [369] 1.936905 3.144531 3.184731 2.283068 2.409485 1.728946 4.570679 4.402861</span></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [377] 4.916134 2.349945 4.675354 4.664307 3.292325 2.157443 3.532034 4.424982</span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [385] 4.074768 4.896694 4.358226 2.311310 3.726590 3.015447 3.681600 4.969613</span></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [393] 2.488953 2.328379 3.550172 4.602843 3.802612 4.696035 4.574707 4.006093</span></span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [401] 3.893753 4.331733 3.730713 4.537598 2.354017 4.375674 4.304613 4.836199</span></span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [409] 4.999268 4.829179 3.318237 4.121094 2.585449 4.685851 4.022028 4.823242</span></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [417] 4.928860 2.574462 2.792725 4.440241 4.267936 4.459229 4.037598 2.681641</span></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [425] 3.636063 4.099470 3.484864 4.835382 4.030197 4.965694 3.044899 4.963444</span></span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [433] 4.151367 4.356445 4.242188 4.018420 4.086425 4.748291 4.875027 2.393440</span></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [441] 4.611477 3.831183 3.592084 2.666747 4.245511 4.447388 3.375265 4.155386</span></span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [449] 3.733628 2.018555 4.718811 4.296753 3.305664 4.881412 4.944336 4.506951</span></span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [457] 4.219727 4.868225 2.236110 4.212116 4.623746 3.489990 4.505942</span></span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a><span class="fu">factor</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(<span class="fu">round</span>(pred_grid<span class="sc">$</span>substrate))))</span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1 2 3 4 5</span></span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Levels: 1 2 3 4 5</span></span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a>pred_grid<span class="sc">$</span>substrate <span class="ot">&lt;-</span> <span class="fu">round</span>(pred_grid<span class="sc">$</span>substrate)</span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a>pred_grid <span class="ot">&lt;-</span> pred_grid <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">substrate =</span> <span class="fu">ifelse</span>(substrate <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"bedrock"</span>, substrate),</span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">substrate =</span> <span class="fu">ifelse</span>(substrate <span class="sc">==</span> <span class="dv">2</span>, <span class="st">"hard-bottom complex"</span>, substrate),</span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">substrate =</span> <span class="fu">ifelse</span>(substrate <span class="sc">==</span> <span class="dv">3</span>, <span class="st">"sand"</span>, substrate),</span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">substrate =</span> <span class="fu">ifelse</span>(substrate <span class="sc">==</span> <span class="dv">4</span>, <span class="st">"hard clay"</span>, substrate),</span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">substrate =</span> <span class="fu">ifelse</span>(substrate <span class="sc">==</span> <span class="dv">5</span>, <span class="st">"mud"</span>, substrate))</span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mutate: converted 'substrate' from double to character (0 new NA)</span></span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a><span class="co"># I. Bedrock.</span></span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a><span class="co"># II. Hard bottom complex, includes patchy hard surfaces and coarse sand (sometimes also clay) to boulders.</span></span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a><span class="co"># III. Sand including fine to coarse sand (with gravel exposures).</span></span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a><span class="co"># IV. Hard clay sometimes/often/possibly exposed or covered with a thin layer of sand/gravel.</span></span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a><span class="co"># V. Mud including gyttja-clay to gyttja-silt.</span></span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_grid, <span class="fu">aes</span>(X, Y, <span class="at">fill =</span> substrate)) <span class="sc">+</span></span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>() <span class="sc">+</span></span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Add month_year variable for matching with raster layers</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pred_grid_1 <span class="ot">&lt;-</span> pred_grid <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">quarter =</span> <span class="dv">1</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mutate: new variable 'quarter' (double) with one unique value and 0% NA</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>pred_grid_4 <span class="ot">&lt;-</span> pred_grid <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">quarter =</span> <span class="dv">4</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mutate: new variable 'quarter' (double) with one unique value and 0% NA</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(pred_grid_1, pred_grid_4) <span class="sc">|&gt;</span> </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">ifelse</span>(quarter <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">11</span>), <span class="co"># most common months</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">month_year =</span> <span class="fu">paste</span>(month, year, <span class="at">sep =</span> <span class="st">"_"</span>))</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mutate: new variable 'month' (double) with 2 unique values and 0% NA</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         new variable 'month_year' (character) with 56 unique values and 0% NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="oxygen" class="level2">
<h2 class="anchored" data-anchor-id="oxygen">Oxygen</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Downloaded from here: https://resources.marine.copernicus.eu/?option=com_csw&amp;view=details&amp;product_id=BALTICSEA_REANALYSIS_BIO_003_012</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract raster points: https://gisday.wordpress.com/2014/03/24/extract-raster-values-from-points-using-r/comment-page-1/</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># https://rpubs.com/boyerag/297592</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># https://pjbartlein.github.io/REarthSysSci/netCDF.html#get-a-variable</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Open the netCDF file</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>ncin <span class="ot">&lt;-</span> <span class="fu">nc_open</span>(<span class="st">"data/NEMO_Nordic_SCOBI/dataset-reanalysis-scobi-monthlymeans_1664182224542.nc"</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ncin)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; File data/NEMO_Nordic_SCOBI/dataset-reanalysis-scobi-monthlymeans_1664182224542.nc (NC_FORMAT_CLASSIC):</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      1 variables (excluding dimension variables):</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         float o2b[longitude,latitude,time]   </span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             long_name: Sea_floor_Dissolved_Oxygen_Concentration</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             missing_value: NaN</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             standard_name: mole_concentration_of_dissolved_molecular_oxygen_in_sea_water</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             units: mmol m-3</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             _FillValue: NaN</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             _ChunkSizes: 1</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              _ChunkSizes: 523</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              _ChunkSizes: 383</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      3 dimensions:</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         time  Size:336 </span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             axis: T</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             long_name: Validity time</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             standard_name: time</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             units: days since 1950-01-01 00:00:00</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             calendar: gregorian</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             _ChunkSizes: 512</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             _CoordinateAxisType: Time</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             valid_min: 15721.5</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             valid_max: 25917.5</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         latitude  Size:523 </span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             axis: Y</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             standard_name: latitude</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             long_name: latitude</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             units: degrees_north</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             _CoordinateAxisType: Lat</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             valid_min: 48.49169921875</span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             valid_max: 65.8914184570312</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         longitude  Size:383 </span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             standard_name: longitude</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             long_name: longitude</span></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             units: degrees_east</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             axis: X</span></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             _CoordinateAxisType: Lon</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             valid_min: 9.01375484466553</span></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             valid_max: 30.2357654571533</span></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     24 global attributes:</span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         references: http://www.smhi.se</span></span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         institution: Swedish Meterological and Hydrological Institute</span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         history: See source and creation_date attributees</span></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Conventions: CF-1.5</span></span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         contact: servicedesk_cmems@mercator-ocean.eu</span></span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         comment: Provided by SMHI as a Copernicus Marine Environment Monitoring Service production unit</span></span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         bullentin_type: reanalysis</span></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         cmems_product_id: BALTICSEA_REANALYSIS_BIO_003_012</span></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         title: CMEMS V4 Reanalysis: SCOBI model 3D fields (monthly means)</span></span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         FROM_ORIGINAL_FILE__easternmost_longitude: 30.2357654571533</span></span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         FROM_ORIGINAL_FILE__northernmost_latitude: 65.8914184570312</span></span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         FROM_ORIGINAL_FILE__westernmost_longitude: 9.01375484466553</span></span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         FROM_ORIGINAL_FILE__southernmost_latitude: 48.49169921875</span></span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         shallowest_depth: 1.50136542320251</span></span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         deepest_depth: 711.059204101562</span></span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         source: SMHI reanalysis run NORDIC-NS2_1d_20201201_20201201</span></span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         file_quality_index: 1</span></span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         creation_date: 2021-11-09 UTC</span></span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         bullentin_date: 20201201</span></span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         start_date: 2020-12-01 UTC</span></span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         stop_date: 2020-12-01 UTC</span></span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         start_time: 00:00 UTC</span></span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         stop_time: 00:00 UTC</span></span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         _CoordSysBuilder: ucar.nc2.dataset.conv.CF1Convention</span></span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true" tabindex="-1"></a><span class="co"># Get longitude and latitude</span></span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true" tabindex="-1"></a>lon <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(ncin,<span class="st">"longitude"</span>)</span>
<span id="cb16-78"><a href="#cb16-78" aria-hidden="true" tabindex="-1"></a>nlon <span class="ot">&lt;-</span> <span class="fu">dim</span>(lon)</span>
<span id="cb16-79"><a href="#cb16-79" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lon)</span>
<span id="cb16-80"><a href="#cb16-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 9.013755 9.069310 9.124865 9.180420 9.235975 9.291530</span></span>
<span id="cb16-81"><a href="#cb16-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-82"><a href="#cb16-82" aria-hidden="true" tabindex="-1"></a>lat <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(ncin,<span class="st">"latitude"</span>)</span>
<span id="cb16-83"><a href="#cb16-83" aria-hidden="true" tabindex="-1"></a>nlat <span class="ot">&lt;-</span> <span class="fu">dim</span>(lat)</span>
<span id="cb16-84"><a href="#cb16-84" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lat)</span>
<span id="cb16-85"><a href="#cb16-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 48.49170 48.52503 48.55836 48.59170 48.62503 48.65836</span></span>
<span id="cb16-86"><a href="#cb16-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-87"><a href="#cb16-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Get time</span></span>
<span id="cb16-88"><a href="#cb16-88" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(ncin,<span class="st">"time"</span>)</span>
<span id="cb16-89"><a href="#cb16-89" aria-hidden="true" tabindex="-1"></a>time</span>
<span id="cb16-90"><a href="#cb16-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   [1] 15721.5 15751.0 15780.5 15811.0 15841.5 15872.0 15902.5 15933.5 15964.0</span></span>
<span id="cb16-91"><a href="#cb16-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [10] 15994.5 16025.0 16055.5 16086.5 16116.0 16145.5 16176.0 16206.5 16237.0</span></span>
<span id="cb16-92"><a href="#cb16-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [19] 16267.5 16298.5 16329.0 16359.5 16390.0 16420.5 16451.5 16481.0 16510.5</span></span>
<span id="cb16-93"><a href="#cb16-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [28] 16541.0 16571.5 16602.0 16632.5 16663.5 16694.0 16724.5 16755.0 16785.5</span></span>
<span id="cb16-94"><a href="#cb16-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [37] 16816.5 16846.5 16876.5 16907.0 16937.5 16968.0 16998.5 17029.5 17060.0</span></span>
<span id="cb16-95"><a href="#cb16-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [46] 17090.5 17121.0 17151.5 17182.5 17212.0 17241.5 17272.0 17302.5 17333.0</span></span>
<span id="cb16-96"><a href="#cb16-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [55] 17363.5 17394.5 17425.0 17455.5 17486.0 17516.5 17547.5 17577.0 17606.5</span></span>
<span id="cb16-97"><a href="#cb16-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [64] 17637.0 17667.5 17698.0 17728.5 17759.5 17790.0 17820.5 17851.0 17881.5</span></span>
<span id="cb16-98"><a href="#cb16-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [73] 17912.5 17942.0 17971.5 18002.0 18032.5 18063.0 18093.5 18124.5 18155.0</span></span>
<span id="cb16-99"><a href="#cb16-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [82] 18185.5 18216.0 18246.5 18277.5 18307.5 18337.5 18368.0 18398.5 18429.0</span></span>
<span id="cb16-100"><a href="#cb16-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [91] 18459.5 18490.5 18521.0 18551.5 18582.0 18612.5 18643.5 18673.0 18702.5</span></span>
<span id="cb16-101"><a href="#cb16-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [100] 18733.0 18763.5 18794.0 18824.5 18855.5 18886.0 18916.5 18947.0 18977.5</span></span>
<span id="cb16-102"><a href="#cb16-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [109] 19008.5 19038.0 19067.5 19098.0 19128.5 19159.0 19189.5 19220.5 19251.0</span></span>
<span id="cb16-103"><a href="#cb16-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [118] 19281.5 19312.0 19342.5 19373.5 19403.0 19432.5 19463.0 19493.5 19524.0</span></span>
<span id="cb16-104"><a href="#cb16-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [127] 19554.5 19585.5 19616.0 19646.5 19677.0 19707.5 19738.5 19768.5 19798.5</span></span>
<span id="cb16-105"><a href="#cb16-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [136] 19829.0 19859.5 19890.0 19920.5 19951.5 19982.0 20012.5 20043.0 20073.5</span></span>
<span id="cb16-106"><a href="#cb16-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [145] 20104.5 20134.0 20163.5 20194.0 20224.5 20255.0 20285.5 20316.5 20347.0</span></span>
<span id="cb16-107"><a href="#cb16-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [154] 20377.5 20408.0 20438.5 20469.5 20499.0 20528.5 20559.0 20589.5 20620.0</span></span>
<span id="cb16-108"><a href="#cb16-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [163] 20650.5 20681.5 20712.0 20742.5 20773.0 20803.5 20834.5 20864.0 20893.5</span></span>
<span id="cb16-109"><a href="#cb16-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [172] 20924.0 20954.5 20985.0 21015.5 21046.5 21077.0 21107.5 21138.0 21168.5</span></span>
<span id="cb16-110"><a href="#cb16-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [181] 21199.5 21229.5 21259.5 21290.0 21320.5 21351.0 21381.5 21412.5 21443.0</span></span>
<span id="cb16-111"><a href="#cb16-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [190] 21473.5 21504.0 21534.5 21565.5 21595.0 21624.5 21655.0 21685.5 21716.0</span></span>
<span id="cb16-112"><a href="#cb16-112" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [199] 21746.5 21777.5 21808.0 21838.5 21869.0 21899.5 21930.5 21960.0 21989.5</span></span>
<span id="cb16-113"><a href="#cb16-113" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [208] 22020.0 22050.5 22081.0 22111.5 22142.5 22173.0 22203.5 22234.0 22264.5</span></span>
<span id="cb16-114"><a href="#cb16-114" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [217] 22295.5 22325.0 22354.5 22385.0 22415.5 22446.0 22476.5 22507.5 22538.0</span></span>
<span id="cb16-115"><a href="#cb16-115" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [226] 22568.5 22599.0 22629.5 22660.5 22690.5 22720.5 22751.0 22781.5 22812.0</span></span>
<span id="cb16-116"><a href="#cb16-116" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [235] 22842.5 22873.5 22904.0 22934.5 22965.0 22995.5 23026.5 23056.0 23085.5</span></span>
<span id="cb16-117"><a href="#cb16-117" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [244] 23116.0 23146.5 23177.0 23207.5 23238.5 23269.0 23299.5 23330.0 23360.5</span></span>
<span id="cb16-118"><a href="#cb16-118" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [253] 23391.5 23421.0 23450.5 23481.0 23511.5 23542.0 23572.5 23603.5 23634.0</span></span>
<span id="cb16-119"><a href="#cb16-119" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [262] 23664.5 23695.0 23725.5 23756.5 23786.0 23815.5 23846.0 23876.5 23907.0</span></span>
<span id="cb16-120"><a href="#cb16-120" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [271] 23937.5 23968.5 23999.0 24029.5 24060.0 24090.5 24121.5 24151.5 24181.5</span></span>
<span id="cb16-121"><a href="#cb16-121" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [280] 24212.0 24242.5 24273.0 24303.5 24334.5 24365.0 24395.5 24426.0 24456.5</span></span>
<span id="cb16-122"><a href="#cb16-122" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [289] 24487.5 24517.0 24546.5 24577.0 24607.5 24638.0 24668.5 24699.5 24730.0</span></span>
<span id="cb16-123"><a href="#cb16-123" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [298] 24760.5 24791.0 24821.5 24852.5 24882.0 24911.5 24942.0 24972.5 25003.0</span></span>
<span id="cb16-124"><a href="#cb16-124" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [307] 25033.5 25064.5 25095.0 25125.5 25156.0 25186.5 25217.5 25247.0 25276.5</span></span>
<span id="cb16-125"><a href="#cb16-125" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [316] 25307.0 25337.5 25368.0 25398.5 25429.5 25460.0 25490.5 25521.0 25551.5</span></span>
<span id="cb16-126"><a href="#cb16-126" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [325] 25582.5 25612.5 25642.5 25673.0 25703.5 25734.0 25764.5 25795.5 25826.0</span></span>
<span id="cb16-127"><a href="#cb16-127" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [334] 25856.5 25887.0 25917.5</span></span>
<span id="cb16-128"><a href="#cb16-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-129"><a href="#cb16-129" aria-hidden="true" tabindex="-1"></a>tunits <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,<span class="st">"time"</span>,<span class="st">"units"</span>)</span>
<span id="cb16-130"><a href="#cb16-130" aria-hidden="true" tabindex="-1"></a>nt <span class="ot">&lt;-</span> <span class="fu">dim</span>(time)</span>
<span id="cb16-131"><a href="#cb16-131" aria-hidden="true" tabindex="-1"></a>nt</span>
<span id="cb16-132"><a href="#cb16-132" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 336</span></span>
<span id="cb16-133"><a href="#cb16-133" aria-hidden="true" tabindex="-1"></a>tunits</span>
<span id="cb16-134"><a href="#cb16-134" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $hasatt</span></span>
<span id="cb16-135"><a href="#cb16-135" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb16-136"><a href="#cb16-136" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-137"><a href="#cb16-137" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $value</span></span>
<span id="cb16-138"><a href="#cb16-138" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] "days since 1950-01-01 00:00:00"</span></span>
<span id="cb16-139"><a href="#cb16-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-140"><a href="#cb16-140" aria-hidden="true" tabindex="-1"></a><span class="co"># Get oxygen</span></span>
<span id="cb16-141"><a href="#cb16-141" aria-hidden="true" tabindex="-1"></a>dname <span class="ot">&lt;-</span> <span class="st">"o2b"</span></span>
<span id="cb16-142"><a href="#cb16-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-143"><a href="#cb16-143" aria-hidden="true" tabindex="-1"></a>oxy_array <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(ncin,dname)</span>
<span id="cb16-144"><a href="#cb16-144" aria-hidden="true" tabindex="-1"></a>dlname <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,dname,<span class="st">"long_name"</span>)</span>
<span id="cb16-145"><a href="#cb16-145" aria-hidden="true" tabindex="-1"></a>dunits <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,dname,<span class="st">"units"</span>)</span>
<span id="cb16-146"><a href="#cb16-146" aria-hidden="true" tabindex="-1"></a>fillvalue <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,dname,<span class="st">"_FillValue"</span>)</span>
<span id="cb16-147"><a href="#cb16-147" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(oxy_array)</span>
<span id="cb16-148"><a href="#cb16-148" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 383 523 336</span></span>
<span id="cb16-149"><a href="#cb16-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-150"><a href="#cb16-150" aria-hidden="true" tabindex="-1"></a><span class="co"># Get global attributes</span></span>
<span id="cb16-151"><a href="#cb16-151" aria-hidden="true" tabindex="-1"></a>title <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,<span class="dv">0</span>,<span class="st">"title"</span>)</span>
<span id="cb16-152"><a href="#cb16-152" aria-hidden="true" tabindex="-1"></a>institution <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,<span class="dv">0</span>,<span class="st">"institution"</span>)</span>
<span id="cb16-153"><a href="#cb16-153" aria-hidden="true" tabindex="-1"></a>datasource <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,<span class="dv">0</span>,<span class="st">"source"</span>)</span>
<span id="cb16-154"><a href="#cb16-154" aria-hidden="true" tabindex="-1"></a>references <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,<span class="dv">0</span>,<span class="st">"references"</span>)</span>
<span id="cb16-155"><a href="#cb16-155" aria-hidden="true" tabindex="-1"></a>history <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,<span class="dv">0</span>,<span class="st">"history"</span>)</span>
<span id="cb16-156"><a href="#cb16-156" aria-hidden="true" tabindex="-1"></a>Conventions <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,<span class="dv">0</span>,<span class="st">"Conventions"</span>)</span>
<span id="cb16-157"><a href="#cb16-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-158"><a href="#cb16-158" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert time: split the time units string into fields</span></span>
<span id="cb16-159"><a href="#cb16-159" aria-hidden="true" tabindex="-1"></a>tustr <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(tunits<span class="sc">$</span>value, <span class="st">" "</span>)</span>
<span id="cb16-160"><a href="#cb16-160" aria-hidden="true" tabindex="-1"></a>tdstr <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(<span class="fu">unlist</span>(tustr)[<span class="dv">3</span>], <span class="st">"-"</span>)</span>
<span id="cb16-161"><a href="#cb16-161" aria-hidden="true" tabindex="-1"></a>tmonth <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">unlist</span>(tdstr)[<span class="dv">2</span>])</span>
<span id="cb16-162"><a href="#cb16-162" aria-hidden="true" tabindex="-1"></a>tday <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">unlist</span>(tdstr)[<span class="dv">3</span>])</span>
<span id="cb16-163"><a href="#cb16-163" aria-hidden="true" tabindex="-1"></a>tyear <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">unlist</span>(tdstr)[<span class="dv">1</span>])</span>
<span id="cb16-164"><a href="#cb16-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-165"><a href="#cb16-165" aria-hidden="true" tabindex="-1"></a><span class="co"># Here I deviate from the guide a little bit. Save this info:</span></span>
<span id="cb16-166"><a href="#cb16-166" aria-hidden="true" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">chron</span>(time, <span class="at">origin =</span> <span class="fu">c</span>(tmonth, tday, tyear))</span>
<span id="cb16-167"><a href="#cb16-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-168"><a href="#cb16-168" aria-hidden="true" tabindex="-1"></a><span class="co"># Crop the date variable</span></span>
<span id="cb16-169"><a href="#cb16-169" aria-hidden="true" tabindex="-1"></a>months <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(dates, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb16-170"><a href="#cb16-170" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(dates, <span class="dv">8</span>, <span class="dv">9</span>))</span>
<span id="cb16-171"><a href="#cb16-171" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(years <span class="sc">&gt;</span> <span class="dv">90</span>, <span class="dv">1900</span> <span class="sc">+</span> years, <span class="dv">2000</span> <span class="sc">+</span> years)</span>
<span id="cb16-172"><a href="#cb16-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-173"><a href="#cb16-173" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace netCDF fill values with NA's</span></span>
<span id="cb16-174"><a href="#cb16-174" aria-hidden="true" tabindex="-1"></a>oxy_array[oxy_array <span class="sc">==</span> fillvalue<span class="sc">$</span>value] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb16-175"><a href="#cb16-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-176"><a href="#cb16-176" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(oxy_array)</span>
<span id="cb16-177"><a href="#cb16-177" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 383 523 336</span></span>
<span id="cb16-178"><a href="#cb16-178" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">dim</span>(oxy_array))</span>
<span id="cb16-179"><a href="#cb16-179" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  int [1:3] 383 523 336</span></span>
<span id="cb16-180"><a href="#cb16-180" aria-hidden="true" tabindex="-1"></a><span class="co"># The third slot is the date index</span></span>
<span id="cb16-181"><a href="#cb16-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-182"><a href="#cb16-182" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through all "dates", put into a list </span></span>
<span id="cb16-183"><a href="#cb16-183" aria-hidden="true" tabindex="-1"></a>dlist <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb16-184"><a href="#cb16-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-185"><a href="#cb16-185" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(months)) {</span>
<span id="cb16-186"><a href="#cb16-186" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-187"><a href="#cb16-187" aria-hidden="true" tabindex="-1"></a>  oxy_sub <span class="ot">&lt;-</span> oxy_array[, , i]</span>
<span id="cb16-188"><a href="#cb16-188" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-189"><a href="#cb16-189" aria-hidden="true" tabindex="-1"></a>  dlist[[i]] <span class="ot">&lt;-</span> oxy_sub</span>
<span id="cb16-190"><a href="#cb16-190" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-191"><a href="#cb16-191" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-192"><a href="#cb16-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-193"><a href="#cb16-193" aria-hidden="true" tabindex="-1"></a><span class="co"># Name the list</span></span>
<span id="cb16-194"><a href="#cb16-194" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dlist) <span class="ot">&lt;-</span> <span class="fu">paste</span>(months, years, <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb16-195"><a href="#cb16-195" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dlist)</span>
<span id="cb16-196"><a href="#cb16-196" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; List of 336</span></span>
<span id="cb16-197"><a href="#cb16-197" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_1993 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-198"><a href="#cb16-198" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_1993 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-199"><a href="#cb16-199" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_1993 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-200"><a href="#cb16-200" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_1993 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-201"><a href="#cb16-201" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_1993 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-202"><a href="#cb16-202" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_1993 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-203"><a href="#cb16-203" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_1993 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-204"><a href="#cb16-204" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_1993 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-205"><a href="#cb16-205" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_1993 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-206"><a href="#cb16-206" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_1993: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-207"><a href="#cb16-207" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_1993: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-208"><a href="#cb16-208" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_1993: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-209"><a href="#cb16-209" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_1994 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-210"><a href="#cb16-210" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_1994 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-211"><a href="#cb16-211" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_1994 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-212"><a href="#cb16-212" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_1994 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-213"><a href="#cb16-213" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_1994 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-214"><a href="#cb16-214" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_1994 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-215"><a href="#cb16-215" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_1994 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-216"><a href="#cb16-216" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_1994 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-217"><a href="#cb16-217" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_1994 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-218"><a href="#cb16-218" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_1994: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-219"><a href="#cb16-219" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_1994: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-220"><a href="#cb16-220" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_1994: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-221"><a href="#cb16-221" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_1995 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-222"><a href="#cb16-222" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_1995 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-223"><a href="#cb16-223" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_1995 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-224"><a href="#cb16-224" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_1995 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-225"><a href="#cb16-225" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_1995 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-226"><a href="#cb16-226" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_1995 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-227"><a href="#cb16-227" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_1995 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-228"><a href="#cb16-228" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_1995 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-229"><a href="#cb16-229" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_1995 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-230"><a href="#cb16-230" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_1995: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-231"><a href="#cb16-231" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_1995: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-232"><a href="#cb16-232" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_1995: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-233"><a href="#cb16-233" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_1996 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-234"><a href="#cb16-234" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_1996 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-235"><a href="#cb16-235" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_1996 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-236"><a href="#cb16-236" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_1996 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-237"><a href="#cb16-237" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_1996 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-238"><a href="#cb16-238" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_1996 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-239"><a href="#cb16-239" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_1996 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-240"><a href="#cb16-240" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_1996 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-241"><a href="#cb16-241" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_1996 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-242"><a href="#cb16-242" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_1996: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-243"><a href="#cb16-243" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_1996: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-244"><a href="#cb16-244" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_1996: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-245"><a href="#cb16-245" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_1997 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-246"><a href="#cb16-246" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_1997 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-247"><a href="#cb16-247" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_1997 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-248"><a href="#cb16-248" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_1997 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-249"><a href="#cb16-249" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_1997 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-250"><a href="#cb16-250" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_1997 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-251"><a href="#cb16-251" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_1997 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-252"><a href="#cb16-252" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_1997 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-253"><a href="#cb16-253" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_1997 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-254"><a href="#cb16-254" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_1997: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-255"><a href="#cb16-255" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_1997: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-256"><a href="#cb16-256" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_1997: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-257"><a href="#cb16-257" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_1998 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-258"><a href="#cb16-258" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_1998 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-259"><a href="#cb16-259" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_1998 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-260"><a href="#cb16-260" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_1998 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-261"><a href="#cb16-261" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_1998 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-262"><a href="#cb16-262" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_1998 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-263"><a href="#cb16-263" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_1998 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-264"><a href="#cb16-264" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_1998 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-265"><a href="#cb16-265" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_1998 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-266"><a href="#cb16-266" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_1998: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-267"><a href="#cb16-267" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_1998: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-268"><a href="#cb16-268" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_1998: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-269"><a href="#cb16-269" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_1999 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-270"><a href="#cb16-270" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_1999 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-271"><a href="#cb16-271" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_1999 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-272"><a href="#cb16-272" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_1999 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-273"><a href="#cb16-273" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_1999 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-274"><a href="#cb16-274" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_1999 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-275"><a href="#cb16-275" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_1999 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-276"><a href="#cb16-276" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_1999 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-277"><a href="#cb16-277" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_1999 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-278"><a href="#cb16-278" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_1999: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-279"><a href="#cb16-279" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_1999: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-280"><a href="#cb16-280" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_1999: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-281"><a href="#cb16-281" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_2000 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-282"><a href="#cb16-282" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_2000 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-283"><a href="#cb16-283" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_2000 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-284"><a href="#cb16-284" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_2000 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-285"><a href="#cb16-285" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_2000 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-286"><a href="#cb16-286" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_2000 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-287"><a href="#cb16-287" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_2000 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-288"><a href="#cb16-288" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_2000 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-289"><a href="#cb16-289" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_2000 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-290"><a href="#cb16-290" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_2000: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-291"><a href="#cb16-291" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_2000: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-292"><a href="#cb16-292" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_2000: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-293"><a href="#cb16-293" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_2001 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-294"><a href="#cb16-294" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_2001 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-295"><a href="#cb16-295" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_2001 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb16-296"><a href="#cb16-296" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   [list output truncated]</span></span>
<span id="cb16-297"><a href="#cb16-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-298"><a href="#cb16-298" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data holding object</span></span>
<span id="cb16-299"><a href="#cb16-299" aria-hidden="true" tabindex="-1"></a>oxy_data_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb16-300"><a href="#cb16-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-301"><a href="#cb16-301" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each month_year and extract raster values for the cpue data points</span></span>
<span id="cb16-302"><a href="#cb16-302" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">unique</span>(dat<span class="sc">$</span>month_year)) { <span class="co"># We can use q1 as looping index, doesn't matter!</span></span>
<span id="cb16-303"><a href="#cb16-303" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-304"><a href="#cb16-304" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set plot limits</span></span>
<span id="cb16-305"><a href="#cb16-305" aria-hidden="true" tabindex="-1"></a>  ymin <span class="ot">=</span> <span class="dv">54</span>; ymax <span class="ot">=</span> <span class="dv">58</span>; xmin <span class="ot">=</span> <span class="dv">12</span>; xmax <span class="ot">=</span> <span class="dv">22</span></span>
<span id="cb16-306"><a href="#cb16-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-307"><a href="#cb16-307" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset a month-year combination</span></span>
<span id="cb16-308"><a href="#cb16-308" aria-hidden="true" tabindex="-1"></a>  oxy_slice <span class="ot">&lt;-</span> dlist[[i]]</span>
<span id="cb16-309"><a href="#cb16-309" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-310"><a href="#cb16-310" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create raster for that year (i)</span></span>
<span id="cb16-311"><a href="#cb16-311" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="fu">t</span>(oxy_slice), <span class="at">xmn =</span> <span class="fu">min</span>(lon), <span class="at">xmx =</span> <span class="fu">max</span>(lon), <span class="at">ymn =</span> <span class="fu">min</span>(lat), <span class="at">ymx =</span> <span class="fu">max</span>(lat),</span>
<span id="cb16-312"><a href="#cb16-312" aria-hidden="true" tabindex="-1"></a>              <span class="at">crs =</span> <span class="fu">CRS</span>(<span class="st">"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs+ towgs84=0,0,0"</span>))</span>
<span id="cb16-313"><a href="#cb16-313" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-314"><a href="#cb16-314" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Flip...</span></span>
<span id="cb16-315"><a href="#cb16-315" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">flip</span>(r, <span class="at">direction =</span> <span class="st">'y'</span>)</span>
<span id="cb16-316"><a href="#cb16-316" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-317"><a href="#cb16-317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(r, <span class="at">main =</span> <span class="fu">paste</span>(i), <span class="at">ylim =</span> <span class="fu">c</span>(ymin, ymax), <span class="at">xlim =</span> <span class="fu">c</span>(xmin, xmax))</span>
<span id="cb16-318"><a href="#cb16-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-319"><a href="#cb16-319" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter the same year (i) in the cpue data and select only coordinates</span></span>
<span id="cb16-320"><a href="#cb16-320" aria-hidden="true" tabindex="-1"></a>  d_slice <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(month_year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(lon, lat)</span>
<span id="cb16-321"><a href="#cb16-321" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-322"><a href="#cb16-322" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make into a SpatialPoints object</span></span>
<span id="cb16-323"><a href="#cb16-323" aria-hidden="true" tabindex="-1"></a>  data_sp <span class="ot">&lt;-</span> <span class="fu">SpatialPoints</span>(d_slice)</span>
<span id="cb16-324"><a href="#cb16-324" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-325"><a href="#cb16-325" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract raster value (oxygen)</span></span>
<span id="cb16-326"><a href="#cb16-326" aria-hidden="true" tabindex="-1"></a>  rasValue <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">extract</span>(r, data_sp)</span>
<span id="cb16-327"><a href="#cb16-327" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-328"><a href="#cb16-328" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Now we want to plot the results of the raster extractions by plotting the cpue data points over a raster and saving it for each year.</span></span>
<span id="cb16-329"><a href="#cb16-329" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make the SpatialPoints object into a raster again (for plot)</span></span>
<span id="cb16-330"><a href="#cb16-330" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data_sp)</span>
<span id="cb16-331"><a href="#cb16-331" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-332"><a href="#cb16-332" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add in the raster value in the df holding the coordinates for the cpue data</span></span>
<span id="cb16-333"><a href="#cb16-333" aria-hidden="true" tabindex="-1"></a>  d_slice<span class="sc">$</span>oxy <span class="ot">&lt;-</span> rasValue</span>
<span id="cb16-334"><a href="#cb16-334" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-335"><a href="#cb16-335" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add in which year</span></span>
<span id="cb16-336"><a href="#cb16-336" aria-hidden="true" tabindex="-1"></a>  d_slice<span class="sc">$</span>month_year <span class="ot">&lt;-</span> i</span>
<span id="cb16-337"><a href="#cb16-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-338"><a href="#cb16-338" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Now the unit of oxygen is mmol/m3. I want it to be ml/L. The original model is in unit ml/L</span></span>
<span id="cb16-339"><a href="#cb16-339" aria-hidden="true" tabindex="-1"></a>  <span class="co"># and it's been converted by the data host. Since it was converted without accounting for</span></span>
<span id="cb16-340"><a href="#cb16-340" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pressure or temperature, I can simply use the following conversion factor:</span></span>
<span id="cb16-341"><a href="#cb16-341" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1 ml/l = 103/22.391 = 44.661 μmol/l -&gt; 1 ml/l = 0.044661 mmol/l = 44.661 mmol/m^3 -&gt; 0.0223909 ml/l = 1mmol/m^3</span></span>
<span id="cb16-342"><a href="#cb16-342" aria-hidden="true" tabindex="-1"></a>  <span class="co"># https://ocean.ices.dk/tools/unitconversion.aspx</span></span>
<span id="cb16-343"><a href="#cb16-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-344"><a href="#cb16-344" aria-hidden="true" tabindex="-1"></a>  d_slice<span class="sc">$</span>oxy <span class="ot">&lt;-</span> d_slice<span class="sc">$</span>oxy <span class="sc">*</span> <span class="fl">0.0223909</span></span>
<span id="cb16-345"><a href="#cb16-345" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-346"><a href="#cb16-346" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add each years' data in the list</span></span>
<span id="cb16-347"><a href="#cb16-347" aria-hidden="true" tabindex="-1"></a>  oxy_data_list[[i]] <span class="ot">&lt;-</span> d_slice</span>
<span id="cb16-348"><a href="#cb16-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-349"><a href="#cb16-349" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-350"><a href="#cb16-350" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-15.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-16.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-17.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-18.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-19.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-20.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-21.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-22.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-23.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-24.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-25.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-26.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-27.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-28.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-29.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-30.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-31.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-32.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-33.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-34.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-35.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-36.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-37.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-38.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-39.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-40.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-41.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-42.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-43.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-44.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-45.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-46.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-47.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-48.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-49.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-50.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-51.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-52.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-53.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-54.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-55.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-4-56.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Now create a data frame from the list of all annual values</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>big_dat_oxy <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(oxy_data_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="temperature" class="level4">
<h4 class="anchored" data-anchor-id="temperature">Temperature</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Open the netCDF file</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>ncin <span class="ot">&lt;-</span> <span class="fu">nc_open</span>(<span class="st">"data/NEMO_Nordic_SCOBI/dataset-reanalysis-nemo-monthlymeans_1664183191233.nc"</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>                                        </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ncin)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; File data/NEMO_Nordic_SCOBI/dataset-reanalysis-nemo-monthlymeans_1664183191233.nc (NC_FORMAT_CLASSIC):</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      1 variables (excluding dimension variables):</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         float bottomT[longitude,latitude,time]   </span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             standard_name: sea_water_potential_temperature_at_sea_floor</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             units: degrees_C</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             long_name: Sea floor potential temperature</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             missing_value: NaN</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             _FillValue: NaN</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             _ChunkSizes: 1</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              _ChunkSizes: 523</span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              _ChunkSizes: 383</span></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      3 dimensions:</span></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         time  Size:336 </span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             axis: T</span></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             long_name: Validity time</span></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             standard_name: time</span></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             units: days since 1950-01-01 00:00:00</span></span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             calendar: gregorian</span></span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             _ChunkSizes: 512</span></span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             _CoordinateAxisType: Time</span></span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             valid_min: 15721.5</span></span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             valid_max: 25917.5</span></span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         latitude  Size:523 </span></span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             axis: Y</span></span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             standard_name: latitude</span></span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             long_name: latitude</span></span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             units: degrees_north</span></span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             _CoordinateAxisType: Lat</span></span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             valid_min: 48.49169921875</span></span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             valid_max: 65.8914184570312</span></span>
<span id="cb73-37"><a href="#cb73-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         longitude  Size:383 </span></span>
<span id="cb73-38"><a href="#cb73-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             standard_name: longitude</span></span>
<span id="cb73-39"><a href="#cb73-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             long_name: longitude</span></span>
<span id="cb73-40"><a href="#cb73-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             units: degrees_east</span></span>
<span id="cb73-41"><a href="#cb73-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             axis: X</span></span>
<span id="cb73-42"><a href="#cb73-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             _CoordinateAxisType: Lon</span></span>
<span id="cb73-43"><a href="#cb73-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             valid_min: 9.01375484466553</span></span>
<span id="cb73-44"><a href="#cb73-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             valid_max: 30.2357654571533</span></span>
<span id="cb73-45"><a href="#cb73-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb73-46"><a href="#cb73-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     24 global attributes:</span></span>
<span id="cb73-47"><a href="#cb73-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         references: http://www.smhi.se</span></span>
<span id="cb73-48"><a href="#cb73-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         institution: Swedish Meterological and Hydrological Institute</span></span>
<span id="cb73-49"><a href="#cb73-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         history: See source and creation_date attributees</span></span>
<span id="cb73-50"><a href="#cb73-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Conventions: CF-1.5</span></span>
<span id="cb73-51"><a href="#cb73-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         contact: servicedesk_cmems@mercator-ocean.eu</span></span>
<span id="cb73-52"><a href="#cb73-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         comment: Provided by SMHI as a Copernicus Marine Environment Monitoring Service production unit</span></span>
<span id="cb73-53"><a href="#cb73-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         bullentin_type: reanalysis</span></span>
<span id="cb73-54"><a href="#cb73-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         cmems_product_id: BALTICSEA_REANALYSIS_PHY_003_011</span></span>
<span id="cb73-55"><a href="#cb73-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         title: CMEMS V4 Reanalysis: NEMO model 3D fields (monthly means)</span></span>
<span id="cb73-56"><a href="#cb73-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         FROM_ORIGINAL_FILE__easternmost_longitude: 30.2357654571533</span></span>
<span id="cb73-57"><a href="#cb73-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         FROM_ORIGINAL_FILE__northernmost_latitude: 65.8914184570312</span></span>
<span id="cb73-58"><a href="#cb73-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         FROM_ORIGINAL_FILE__westernmost_longitude: 9.01375484466553</span></span>
<span id="cb73-59"><a href="#cb73-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         FROM_ORIGINAL_FILE__southernmost_latitude: 48.49169921875</span></span>
<span id="cb73-60"><a href="#cb73-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         shallowest_depth: 1.50136542320251</span></span>
<span id="cb73-61"><a href="#cb73-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         deepest_depth: 711.059204101562</span></span>
<span id="cb73-62"><a href="#cb73-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         source: SMHI reanalysis run NORDIC-NS2_1d_20201201_20201201</span></span>
<span id="cb73-63"><a href="#cb73-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         file_quality_index: 1</span></span>
<span id="cb73-64"><a href="#cb73-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         creation_date: 2021-11-09 UTC</span></span>
<span id="cb73-65"><a href="#cb73-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         bullentin_date: 20201201</span></span>
<span id="cb73-66"><a href="#cb73-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         start_date: 2020-12-01 UTC</span></span>
<span id="cb73-67"><a href="#cb73-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         stop_date: 2020-12-01 UTC</span></span>
<span id="cb73-68"><a href="#cb73-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         start_time: 00:00 UTC</span></span>
<span id="cb73-69"><a href="#cb73-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         stop_time: 00:00 UTC</span></span>
<span id="cb73-70"><a href="#cb73-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         _CoordSysBuilder: ucar.nc2.dataset.conv.CF1Convention</span></span>
<span id="cb73-71"><a href="#cb73-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-72"><a href="#cb73-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Get longitude and latitude</span></span>
<span id="cb73-73"><a href="#cb73-73" aria-hidden="true" tabindex="-1"></a>lon <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(ncin,<span class="st">"longitude"</span>)</span>
<span id="cb73-74"><a href="#cb73-74" aria-hidden="true" tabindex="-1"></a>nlon <span class="ot">&lt;-</span> <span class="fu">dim</span>(lon)</span>
<span id="cb73-75"><a href="#cb73-75" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lon)</span>
<span id="cb73-76"><a href="#cb73-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 9.013755 9.069310 9.124865 9.180420 9.235975 9.291530</span></span>
<span id="cb73-77"><a href="#cb73-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-78"><a href="#cb73-78" aria-hidden="true" tabindex="-1"></a>lat <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(ncin,<span class="st">"latitude"</span>)</span>
<span id="cb73-79"><a href="#cb73-79" aria-hidden="true" tabindex="-1"></a>nlat <span class="ot">&lt;-</span> <span class="fu">dim</span>(lat)</span>
<span id="cb73-80"><a href="#cb73-80" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lat)</span>
<span id="cb73-81"><a href="#cb73-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 48.49170 48.52503 48.55836 48.59170 48.62503 48.65836</span></span>
<span id="cb73-82"><a href="#cb73-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-83"><a href="#cb73-83" aria-hidden="true" tabindex="-1"></a><span class="co"># Get time</span></span>
<span id="cb73-84"><a href="#cb73-84" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(ncin,<span class="st">"time"</span>)</span>
<span id="cb73-85"><a href="#cb73-85" aria-hidden="true" tabindex="-1"></a>time</span>
<span id="cb73-86"><a href="#cb73-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   [1] 15721.5 15751.0 15780.5 15811.0 15841.5 15872.0 15902.5 15933.5 15964.0</span></span>
<span id="cb73-87"><a href="#cb73-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [10] 15994.5 16025.0 16055.5 16086.5 16116.0 16145.5 16176.0 16206.5 16237.0</span></span>
<span id="cb73-88"><a href="#cb73-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [19] 16267.5 16298.5 16329.0 16359.5 16390.0 16420.5 16451.5 16481.0 16510.5</span></span>
<span id="cb73-89"><a href="#cb73-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [28] 16541.0 16571.5 16602.0 16632.5 16663.5 16694.0 16724.5 16755.0 16785.5</span></span>
<span id="cb73-90"><a href="#cb73-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [37] 16816.5 16846.5 16876.5 16907.0 16937.5 16968.0 16998.5 17029.5 17060.0</span></span>
<span id="cb73-91"><a href="#cb73-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [46] 17090.5 17121.0 17151.5 17182.5 17212.0 17241.5 17272.0 17302.5 17333.0</span></span>
<span id="cb73-92"><a href="#cb73-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [55] 17363.5 17394.5 17425.0 17455.5 17486.0 17516.5 17547.5 17577.0 17606.5</span></span>
<span id="cb73-93"><a href="#cb73-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [64] 17637.0 17667.5 17698.0 17728.5 17759.5 17790.0 17820.5 17851.0 17881.5</span></span>
<span id="cb73-94"><a href="#cb73-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [73] 17912.5 17942.0 17971.5 18002.0 18032.5 18063.0 18093.5 18124.5 18155.0</span></span>
<span id="cb73-95"><a href="#cb73-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [82] 18185.5 18216.0 18246.5 18277.5 18307.5 18337.5 18368.0 18398.5 18429.0</span></span>
<span id="cb73-96"><a href="#cb73-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [91] 18459.5 18490.5 18521.0 18551.5 18582.0 18612.5 18643.5 18673.0 18702.5</span></span>
<span id="cb73-97"><a href="#cb73-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [100] 18733.0 18763.5 18794.0 18824.5 18855.5 18886.0 18916.5 18947.0 18977.5</span></span>
<span id="cb73-98"><a href="#cb73-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [109] 19008.5 19038.0 19067.5 19098.0 19128.5 19159.0 19189.5 19220.5 19251.0</span></span>
<span id="cb73-99"><a href="#cb73-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [118] 19281.5 19312.0 19342.5 19373.5 19403.0 19432.5 19463.0 19493.5 19524.0</span></span>
<span id="cb73-100"><a href="#cb73-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [127] 19554.5 19585.5 19616.0 19646.5 19677.0 19707.5 19738.5 19768.5 19798.5</span></span>
<span id="cb73-101"><a href="#cb73-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [136] 19829.0 19859.5 19890.0 19920.5 19951.5 19982.0 20012.5 20043.0 20073.5</span></span>
<span id="cb73-102"><a href="#cb73-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [145] 20104.5 20134.0 20163.5 20194.0 20224.5 20255.0 20285.5 20316.5 20347.0</span></span>
<span id="cb73-103"><a href="#cb73-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [154] 20377.5 20408.0 20438.5 20469.5 20499.0 20528.5 20559.0 20589.5 20620.0</span></span>
<span id="cb73-104"><a href="#cb73-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [163] 20650.5 20681.5 20712.0 20742.5 20773.0 20803.5 20834.5 20864.0 20893.5</span></span>
<span id="cb73-105"><a href="#cb73-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [172] 20924.0 20954.5 20985.0 21015.5 21046.5 21077.0 21107.5 21138.0 21168.5</span></span>
<span id="cb73-106"><a href="#cb73-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [181] 21199.5 21229.5 21259.5 21290.0 21320.5 21351.0 21381.5 21412.5 21443.0</span></span>
<span id="cb73-107"><a href="#cb73-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [190] 21473.5 21504.0 21534.5 21565.5 21595.0 21624.5 21655.0 21685.5 21716.0</span></span>
<span id="cb73-108"><a href="#cb73-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [199] 21746.5 21777.5 21808.0 21838.5 21869.0 21899.5 21930.5 21960.0 21989.5</span></span>
<span id="cb73-109"><a href="#cb73-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [208] 22020.0 22050.5 22081.0 22111.5 22142.5 22173.0 22203.5 22234.0 22264.5</span></span>
<span id="cb73-110"><a href="#cb73-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [217] 22295.5 22325.0 22354.5 22385.0 22415.5 22446.0 22476.5 22507.5 22538.0</span></span>
<span id="cb73-111"><a href="#cb73-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [226] 22568.5 22599.0 22629.5 22660.5 22690.5 22720.5 22751.0 22781.5 22812.0</span></span>
<span id="cb73-112"><a href="#cb73-112" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [235] 22842.5 22873.5 22904.0 22934.5 22965.0 22995.5 23026.5 23056.0 23085.5</span></span>
<span id="cb73-113"><a href="#cb73-113" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [244] 23116.0 23146.5 23177.0 23207.5 23238.5 23269.0 23299.5 23330.0 23360.5</span></span>
<span id="cb73-114"><a href="#cb73-114" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [253] 23391.5 23421.0 23450.5 23481.0 23511.5 23542.0 23572.5 23603.5 23634.0</span></span>
<span id="cb73-115"><a href="#cb73-115" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [262] 23664.5 23695.0 23725.5 23756.5 23786.0 23815.5 23846.0 23876.5 23907.0</span></span>
<span id="cb73-116"><a href="#cb73-116" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [271] 23937.5 23968.5 23999.0 24029.5 24060.0 24090.5 24121.5 24151.5 24181.5</span></span>
<span id="cb73-117"><a href="#cb73-117" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [280] 24212.0 24242.5 24273.0 24303.5 24334.5 24365.0 24395.5 24426.0 24456.5</span></span>
<span id="cb73-118"><a href="#cb73-118" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [289] 24487.5 24517.0 24546.5 24577.0 24607.5 24638.0 24668.5 24699.5 24730.0</span></span>
<span id="cb73-119"><a href="#cb73-119" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [298] 24760.5 24791.0 24821.5 24852.5 24882.0 24911.5 24942.0 24972.5 25003.0</span></span>
<span id="cb73-120"><a href="#cb73-120" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [307] 25033.5 25064.5 25095.0 25125.5 25156.0 25186.5 25217.5 25247.0 25276.5</span></span>
<span id="cb73-121"><a href="#cb73-121" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [316] 25307.0 25337.5 25368.0 25398.5 25429.5 25460.0 25490.5 25521.0 25551.5</span></span>
<span id="cb73-122"><a href="#cb73-122" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [325] 25582.5 25612.5 25642.5 25673.0 25703.5 25734.0 25764.5 25795.5 25826.0</span></span>
<span id="cb73-123"><a href="#cb73-123" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [334] 25856.5 25887.0 25917.5</span></span>
<span id="cb73-124"><a href="#cb73-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-125"><a href="#cb73-125" aria-hidden="true" tabindex="-1"></a>tunits <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,<span class="st">"time"</span>,<span class="st">"units"</span>)</span>
<span id="cb73-126"><a href="#cb73-126" aria-hidden="true" tabindex="-1"></a>nt <span class="ot">&lt;-</span> <span class="fu">dim</span>(time)</span>
<span id="cb73-127"><a href="#cb73-127" aria-hidden="true" tabindex="-1"></a>nt</span>
<span id="cb73-128"><a href="#cb73-128" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 336</span></span>
<span id="cb73-129"><a href="#cb73-129" aria-hidden="true" tabindex="-1"></a>tunits</span>
<span id="cb73-130"><a href="#cb73-130" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $hasatt</span></span>
<span id="cb73-131"><a href="#cb73-131" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb73-132"><a href="#cb73-132" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb73-133"><a href="#cb73-133" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $value</span></span>
<span id="cb73-134"><a href="#cb73-134" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] "days since 1950-01-01 00:00:00"</span></span>
<span id="cb73-135"><a href="#cb73-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-136"><a href="#cb73-136" aria-hidden="true" tabindex="-1"></a><span class="co"># Get temperature</span></span>
<span id="cb73-137"><a href="#cb73-137" aria-hidden="true" tabindex="-1"></a>dname <span class="ot">&lt;-</span> <span class="st">"bottomT"</span></span>
<span id="cb73-138"><a href="#cb73-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-139"><a href="#cb73-139" aria-hidden="true" tabindex="-1"></a>temp_array <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(ncin,dname)</span>
<span id="cb73-140"><a href="#cb73-140" aria-hidden="true" tabindex="-1"></a>dlname <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,dname,<span class="st">"long_name"</span>)</span>
<span id="cb73-141"><a href="#cb73-141" aria-hidden="true" tabindex="-1"></a>dunits <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,dname,<span class="st">"units"</span>)</span>
<span id="cb73-142"><a href="#cb73-142" aria-hidden="true" tabindex="-1"></a>fillvalue <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,dname,<span class="st">"_FillValue"</span>)</span>
<span id="cb73-143"><a href="#cb73-143" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(temp_array)</span>
<span id="cb73-144"><a href="#cb73-144" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 383 523 336</span></span>
<span id="cb73-145"><a href="#cb73-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-146"><a href="#cb73-146" aria-hidden="true" tabindex="-1"></a><span class="co"># Get global attributes</span></span>
<span id="cb73-147"><a href="#cb73-147" aria-hidden="true" tabindex="-1"></a>title <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,<span class="dv">0</span>,<span class="st">"title"</span>)</span>
<span id="cb73-148"><a href="#cb73-148" aria-hidden="true" tabindex="-1"></a>institution <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,<span class="dv">0</span>,<span class="st">"institution"</span>)</span>
<span id="cb73-149"><a href="#cb73-149" aria-hidden="true" tabindex="-1"></a>datasource <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,<span class="dv">0</span>,<span class="st">"source"</span>)</span>
<span id="cb73-150"><a href="#cb73-150" aria-hidden="true" tabindex="-1"></a>references <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,<span class="dv">0</span>,<span class="st">"references"</span>)</span>
<span id="cb73-151"><a href="#cb73-151" aria-hidden="true" tabindex="-1"></a>history <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,<span class="dv">0</span>,<span class="st">"history"</span>)</span>
<span id="cb73-152"><a href="#cb73-152" aria-hidden="true" tabindex="-1"></a>Conventions <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,<span class="dv">0</span>,<span class="st">"Conventions"</span>)</span>
<span id="cb73-153"><a href="#cb73-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-154"><a href="#cb73-154" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert time: split the time units string into fields</span></span>
<span id="cb73-155"><a href="#cb73-155" aria-hidden="true" tabindex="-1"></a>tustr <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(tunits<span class="sc">$</span>value, <span class="st">" "</span>)</span>
<span id="cb73-156"><a href="#cb73-156" aria-hidden="true" tabindex="-1"></a>tdstr <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(<span class="fu">unlist</span>(tustr)[<span class="dv">3</span>], <span class="st">"-"</span>)</span>
<span id="cb73-157"><a href="#cb73-157" aria-hidden="true" tabindex="-1"></a>tmonth <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">unlist</span>(tdstr)[<span class="dv">2</span>])</span>
<span id="cb73-158"><a href="#cb73-158" aria-hidden="true" tabindex="-1"></a>tday <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">unlist</span>(tdstr)[<span class="dv">3</span>])</span>
<span id="cb73-159"><a href="#cb73-159" aria-hidden="true" tabindex="-1"></a>tyear <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">unlist</span>(tdstr)[<span class="dv">1</span>])</span>
<span id="cb73-160"><a href="#cb73-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-161"><a href="#cb73-161" aria-hidden="true" tabindex="-1"></a><span class="co"># Here I deviate from the guide a little bit. Save this info:</span></span>
<span id="cb73-162"><a href="#cb73-162" aria-hidden="true" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">chron</span>(time, <span class="at">origin =</span> <span class="fu">c</span>(tmonth, tday, tyear))</span>
<span id="cb73-163"><a href="#cb73-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-164"><a href="#cb73-164" aria-hidden="true" tabindex="-1"></a><span class="co"># Crop the date variable</span></span>
<span id="cb73-165"><a href="#cb73-165" aria-hidden="true" tabindex="-1"></a>months <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(dates, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb73-166"><a href="#cb73-166" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(dates, <span class="dv">8</span>, <span class="dv">9</span>))</span>
<span id="cb73-167"><a href="#cb73-167" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(years <span class="sc">&gt;</span> <span class="dv">90</span>, <span class="dv">1900</span> <span class="sc">+</span> years, <span class="dv">2000</span> <span class="sc">+</span> years)</span>
<span id="cb73-168"><a href="#cb73-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-169"><a href="#cb73-169" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace netCDF fill values with NA's</span></span>
<span id="cb73-170"><a href="#cb73-170" aria-hidden="true" tabindex="-1"></a>temp_array[temp_array <span class="sc">==</span> fillvalue<span class="sc">$</span>value] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb73-171"><a href="#cb73-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-172"><a href="#cb73-172" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through all "dates", put into a list </span></span>
<span id="cb73-173"><a href="#cb73-173" aria-hidden="true" tabindex="-1"></a>dlist <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb73-174"><a href="#cb73-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-175"><a href="#cb73-175" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(months)) {</span>
<span id="cb73-176"><a href="#cb73-176" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-177"><a href="#cb73-177" aria-hidden="true" tabindex="-1"></a>  temp_sub <span class="ot">&lt;-</span> temp_array[, , i]</span>
<span id="cb73-178"><a href="#cb73-178" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-179"><a href="#cb73-179" aria-hidden="true" tabindex="-1"></a>  dlist[[i]] <span class="ot">&lt;-</span> temp_sub</span>
<span id="cb73-180"><a href="#cb73-180" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-181"><a href="#cb73-181" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-182"><a href="#cb73-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-183"><a href="#cb73-183" aria-hidden="true" tabindex="-1"></a><span class="co"># Name the list</span></span>
<span id="cb73-184"><a href="#cb73-184" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dlist) <span class="ot">&lt;-</span> <span class="fu">paste</span>(months, years, <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb73-185"><a href="#cb73-185" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dlist)</span>
<span id="cb73-186"><a href="#cb73-186" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; List of 336</span></span>
<span id="cb73-187"><a href="#cb73-187" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_1993 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-188"><a href="#cb73-188" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_1993 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-189"><a href="#cb73-189" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_1993 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-190"><a href="#cb73-190" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_1993 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-191"><a href="#cb73-191" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_1993 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-192"><a href="#cb73-192" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_1993 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-193"><a href="#cb73-193" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_1993 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-194"><a href="#cb73-194" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_1993 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-195"><a href="#cb73-195" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_1993 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-196"><a href="#cb73-196" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_1993: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-197"><a href="#cb73-197" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_1993: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-198"><a href="#cb73-198" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_1993: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-199"><a href="#cb73-199" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_1994 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-200"><a href="#cb73-200" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_1994 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-201"><a href="#cb73-201" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_1994 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-202"><a href="#cb73-202" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_1994 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-203"><a href="#cb73-203" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_1994 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-204"><a href="#cb73-204" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_1994 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-205"><a href="#cb73-205" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_1994 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-206"><a href="#cb73-206" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_1994 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-207"><a href="#cb73-207" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_1994 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-208"><a href="#cb73-208" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_1994: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-209"><a href="#cb73-209" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_1994: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-210"><a href="#cb73-210" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_1994: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-211"><a href="#cb73-211" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_1995 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-212"><a href="#cb73-212" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_1995 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-213"><a href="#cb73-213" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_1995 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-214"><a href="#cb73-214" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_1995 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-215"><a href="#cb73-215" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_1995 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-216"><a href="#cb73-216" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_1995 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-217"><a href="#cb73-217" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_1995 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-218"><a href="#cb73-218" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_1995 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-219"><a href="#cb73-219" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_1995 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-220"><a href="#cb73-220" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_1995: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-221"><a href="#cb73-221" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_1995: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-222"><a href="#cb73-222" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_1995: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-223"><a href="#cb73-223" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_1996 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-224"><a href="#cb73-224" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_1996 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-225"><a href="#cb73-225" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_1996 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-226"><a href="#cb73-226" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_1996 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-227"><a href="#cb73-227" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_1996 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-228"><a href="#cb73-228" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_1996 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-229"><a href="#cb73-229" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_1996 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-230"><a href="#cb73-230" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_1996 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-231"><a href="#cb73-231" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_1996 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-232"><a href="#cb73-232" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_1996: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-233"><a href="#cb73-233" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_1996: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-234"><a href="#cb73-234" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_1996: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-235"><a href="#cb73-235" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_1997 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-236"><a href="#cb73-236" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_1997 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-237"><a href="#cb73-237" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_1997 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-238"><a href="#cb73-238" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_1997 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-239"><a href="#cb73-239" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_1997 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-240"><a href="#cb73-240" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_1997 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-241"><a href="#cb73-241" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_1997 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-242"><a href="#cb73-242" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_1997 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-243"><a href="#cb73-243" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_1997 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-244"><a href="#cb73-244" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_1997: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-245"><a href="#cb73-245" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_1997: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-246"><a href="#cb73-246" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_1997: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-247"><a href="#cb73-247" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_1998 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-248"><a href="#cb73-248" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_1998 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-249"><a href="#cb73-249" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_1998 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-250"><a href="#cb73-250" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_1998 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-251"><a href="#cb73-251" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_1998 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-252"><a href="#cb73-252" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_1998 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-253"><a href="#cb73-253" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_1998 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-254"><a href="#cb73-254" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_1998 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-255"><a href="#cb73-255" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_1998 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-256"><a href="#cb73-256" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_1998: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-257"><a href="#cb73-257" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_1998: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-258"><a href="#cb73-258" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_1998: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-259"><a href="#cb73-259" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_1999 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-260"><a href="#cb73-260" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_1999 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-261"><a href="#cb73-261" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_1999 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-262"><a href="#cb73-262" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_1999 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-263"><a href="#cb73-263" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_1999 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-264"><a href="#cb73-264" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_1999 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-265"><a href="#cb73-265" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_1999 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-266"><a href="#cb73-266" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_1999 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-267"><a href="#cb73-267" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_1999 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-268"><a href="#cb73-268" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_1999: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-269"><a href="#cb73-269" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_1999: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-270"><a href="#cb73-270" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_1999: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-271"><a href="#cb73-271" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_2000 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-272"><a href="#cb73-272" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_2000 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-273"><a href="#cb73-273" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_2000 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-274"><a href="#cb73-274" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_2000 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-275"><a href="#cb73-275" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_2000 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-276"><a href="#cb73-276" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_2000 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-277"><a href="#cb73-277" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_2000 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-278"><a href="#cb73-278" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_2000 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-279"><a href="#cb73-279" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_2000 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-280"><a href="#cb73-280" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_2000: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-281"><a href="#cb73-281" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_2000: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-282"><a href="#cb73-282" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_2000: num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-283"><a href="#cb73-283" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_2001 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-284"><a href="#cb73-284" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_2001 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-285"><a href="#cb73-285" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_2001 : num [1:383, 1:523] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb73-286"><a href="#cb73-286" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   [list output truncated]</span></span>
<span id="cb73-287"><a href="#cb73-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-288"><a href="#cb73-288" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data holding object</span></span>
<span id="cb73-289"><a href="#cb73-289" aria-hidden="true" tabindex="-1"></a>temp_data_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb73-290"><a href="#cb73-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-291"><a href="#cb73-291" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each month_year and extract raster values for the cpue data points</span></span>
<span id="cb73-292"><a href="#cb73-292" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">unique</span>(dat<span class="sc">$</span>month_year)) { <span class="co"># We can use q1 as looping index, doesn't matter!</span></span>
<span id="cb73-293"><a href="#cb73-293" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-294"><a href="#cb73-294" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set plot limits</span></span>
<span id="cb73-295"><a href="#cb73-295" aria-hidden="true" tabindex="-1"></a>  ymin <span class="ot">=</span> <span class="dv">54</span>; ymax <span class="ot">=</span> <span class="dv">58</span>; xmin <span class="ot">=</span> <span class="dv">12</span>; xmax <span class="ot">=</span> <span class="dv">22</span></span>
<span id="cb73-296"><a href="#cb73-296" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-297"><a href="#cb73-297" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset a month-year combination</span></span>
<span id="cb73-298"><a href="#cb73-298" aria-hidden="true" tabindex="-1"></a>  temp_slice <span class="ot">&lt;-</span> dlist[[i]]</span>
<span id="cb73-299"><a href="#cb73-299" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-300"><a href="#cb73-300" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create raster for that year (i)</span></span>
<span id="cb73-301"><a href="#cb73-301" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="fu">t</span>(temp_slice), <span class="at">xmn =</span> <span class="fu">min</span>(lon), <span class="at">xmx =</span> <span class="fu">max</span>(lon), <span class="at">ymn =</span> <span class="fu">min</span>(lat), <span class="at">ymx =</span> <span class="fu">max</span>(lat),</span>
<span id="cb73-302"><a href="#cb73-302" aria-hidden="true" tabindex="-1"></a>              <span class="at">crs =</span> <span class="fu">CRS</span>(<span class="st">"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs+ towgs84=0,0,0"</span>))</span>
<span id="cb73-303"><a href="#cb73-303" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-304"><a href="#cb73-304" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Flip...</span></span>
<span id="cb73-305"><a href="#cb73-305" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">flip</span>(r, <span class="at">direction =</span> <span class="st">'y'</span>)</span>
<span id="cb73-306"><a href="#cb73-306" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-307"><a href="#cb73-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(r, <span class="at">main =</span> <span class="fu">paste</span>(i), <span class="at">ylim =</span> <span class="fu">c</span>(ymin, ymax), <span class="at">xlim =</span> <span class="fu">c</span>(xmin, xmax))</span>
<span id="cb73-308"><a href="#cb73-308" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-309"><a href="#cb73-309" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter the same year (i) in the cpue data and select only coordinates</span></span>
<span id="cb73-310"><a href="#cb73-310" aria-hidden="true" tabindex="-1"></a>  d_slice <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(month_year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(lon, lat)</span>
<span id="cb73-311"><a href="#cb73-311" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-312"><a href="#cb73-312" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make into a SpatialPoints object</span></span>
<span id="cb73-313"><a href="#cb73-313" aria-hidden="true" tabindex="-1"></a>  data_sp <span class="ot">&lt;-</span> <span class="fu">SpatialPoints</span>(d_slice)</span>
<span id="cb73-314"><a href="#cb73-314" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-315"><a href="#cb73-315" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract raster value (oxygen)</span></span>
<span id="cb73-316"><a href="#cb73-316" aria-hidden="true" tabindex="-1"></a>  rasValue <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">extract</span>(r, data_sp)</span>
<span id="cb73-317"><a href="#cb73-317" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-318"><a href="#cb73-318" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Now we want to plot the results of the raster extractions by plotting the cpue data points over a raster and saving it for each year.</span></span>
<span id="cb73-319"><a href="#cb73-319" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make the SpatialPoints object into a raster again (for plot)</span></span>
<span id="cb73-320"><a href="#cb73-320" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data_sp)</span>
<span id="cb73-321"><a href="#cb73-321" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-322"><a href="#cb73-322" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add in the raster value in the df holding the coordinates for the cpue data</span></span>
<span id="cb73-323"><a href="#cb73-323" aria-hidden="true" tabindex="-1"></a>  d_slice<span class="sc">$</span>temp <span class="ot">&lt;-</span> rasValue</span>
<span id="cb73-324"><a href="#cb73-324" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-325"><a href="#cb73-325" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add in which year</span></span>
<span id="cb73-326"><a href="#cb73-326" aria-hidden="true" tabindex="-1"></a>  d_slice<span class="sc">$</span>month_year <span class="ot">&lt;-</span> i</span>
<span id="cb73-327"><a href="#cb73-327" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-328"><a href="#cb73-328" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add each years' data in the list</span></span>
<span id="cb73-329"><a href="#cb73-329" aria-hidden="true" tabindex="-1"></a>  temp_data_list[[i]] <span class="ot">&lt;-</span> d_slice</span>
<span id="cb73-330"><a href="#cb73-330" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-331"><a href="#cb73-331" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-332"><a href="#cb73-332" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-15.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-16.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-17.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-18.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-19.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-20.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-21.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-22.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-23.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-24.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-25.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-26.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-27.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-28.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-29.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-30.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-31.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-32.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-33.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-34.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-35.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-36.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-37.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-38.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-39.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-40.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-41.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-42.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-43.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-44.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-45.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-46.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-47.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-48.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-49.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-50.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-51.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-52.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-53.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-54.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-55.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-5-56.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Now create a data frame from the list of all annual values</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>big_dat_temp <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(temp_data_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="bottom-salinity" class="level4">
<h4 class="anchored" data-anchor-id="bottom-salinity">Bottom salinity</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://data.marine.copernicus.eu/product/BALTICSEA_REANALYSIS_PHY_003_011/download?dataset=dataset-reanalysis-nemo-monthlymeans</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Open the netCDF file</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>ncin <span class="ot">&lt;-</span> <span class="fu">nc_open</span>(<span class="st">"data/NEMO_Nordic_SCOBI/dataset-reanalysis-nemo-monthlymeans_1668587452211.nc"</span>)</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ncin)</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; File data/NEMO_Nordic_SCOBI/dataset-reanalysis-nemo-monthlymeans_1668587452211.nc (NC_FORMAT_CLASSIC):</span></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      1 variables (excluding dimension variables):</span></span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         float sob[longitude,latitude,time]   </span></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             long_name: Sea water salinity at sea floor</span></span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             missing_value: NaN</span></span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             standard_name: sea_water_salinity</span></span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             units: 0.001</span></span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             _FillValue: NaN</span></span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             _ChunkSizes: 1</span></span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              _ChunkSizes: 523</span></span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              _ChunkSizes: 383</span></span>
<span id="cb130-19"><a href="#cb130-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb130-20"><a href="#cb130-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      3 dimensions:</span></span>
<span id="cb130-21"><a href="#cb130-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         time  Size:335 </span></span>
<span id="cb130-22"><a href="#cb130-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             axis: T</span></span>
<span id="cb130-23"><a href="#cb130-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             long_name: Validity time</span></span>
<span id="cb130-24"><a href="#cb130-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             standard_name: time</span></span>
<span id="cb130-25"><a href="#cb130-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             units: days since 1950-01-01 00:00:00</span></span>
<span id="cb130-26"><a href="#cb130-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             calendar: gregorian</span></span>
<span id="cb130-27"><a href="#cb130-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             _ChunkSizes: 512</span></span>
<span id="cb130-28"><a href="#cb130-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             _CoordinateAxisType: Time</span></span>
<span id="cb130-29"><a href="#cb130-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             valid_min: 15751</span></span>
<span id="cb130-30"><a href="#cb130-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             valid_max: 25917.5</span></span>
<span id="cb130-31"><a href="#cb130-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         latitude  Size:187 </span></span>
<span id="cb130-32"><a href="#cb130-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             axis: Y</span></span>
<span id="cb130-33"><a href="#cb130-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             standard_name: latitude</span></span>
<span id="cb130-34"><a href="#cb130-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             long_name: latitude</span></span>
<span id="cb130-35"><a href="#cb130-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             units: degrees_north</span></span>
<span id="cb130-36"><a href="#cb130-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             _CoordinateAxisType: Lat</span></span>
<span id="cb130-37"><a href="#cb130-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             valid_min: 53.1249580383301</span></span>
<span id="cb130-38"><a href="#cb130-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             valid_max: 59.3248596191406</span></span>
<span id="cb130-39"><a href="#cb130-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         longitude  Size:199 </span></span>
<span id="cb130-40"><a href="#cb130-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             standard_name: longitude</span></span>
<span id="cb130-41"><a href="#cb130-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             long_name: longitude</span></span>
<span id="cb130-42"><a href="#cb130-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             units: degrees_east</span></span>
<span id="cb130-43"><a href="#cb130-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             axis: X</span></span>
<span id="cb130-44"><a href="#cb130-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             _CoordinateAxisType: Lon</span></span>
<span id="cb130-45"><a href="#cb130-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             valid_min: 11.1248445510864</span></span>
<span id="cb130-46"><a href="#cb130-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             valid_max: 22.12473487854</span></span>
<span id="cb130-47"><a href="#cb130-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb130-48"><a href="#cb130-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     24 global attributes:</span></span>
<span id="cb130-49"><a href="#cb130-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         references: http://www.smhi.se</span></span>
<span id="cb130-50"><a href="#cb130-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         institution: Swedish Meterological and Hydrological Institute</span></span>
<span id="cb130-51"><a href="#cb130-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         history: See source and creation_date attributees</span></span>
<span id="cb130-52"><a href="#cb130-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Conventions: CF-1.5</span></span>
<span id="cb130-53"><a href="#cb130-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         contact: servicedesk_cmems@mercator-ocean.eu</span></span>
<span id="cb130-54"><a href="#cb130-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         comment: Provided by SMHI as a Copernicus Marine Environment Monitoring Service production unit</span></span>
<span id="cb130-55"><a href="#cb130-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         bullentin_type: reanalysis</span></span>
<span id="cb130-56"><a href="#cb130-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         cmems_product_id: BALTICSEA_REANALYSIS_PHY_003_011</span></span>
<span id="cb130-57"><a href="#cb130-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         title: CMEMS V4 Reanalysis: NEMO model 3D fields (monthly means)</span></span>
<span id="cb130-58"><a href="#cb130-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         FROM_ORIGINAL_FILE__easternmost_longitude: 30.2357654571533</span></span>
<span id="cb130-59"><a href="#cb130-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         FROM_ORIGINAL_FILE__northernmost_latitude: 65.8914184570312</span></span>
<span id="cb130-60"><a href="#cb130-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         FROM_ORIGINAL_FILE__westernmost_longitude: 9.01375484466553</span></span>
<span id="cb130-61"><a href="#cb130-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         FROM_ORIGINAL_FILE__southernmost_latitude: 48.49169921875</span></span>
<span id="cb130-62"><a href="#cb130-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         shallowest_depth: 1.50136542320251</span></span>
<span id="cb130-63"><a href="#cb130-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         deepest_depth: 711.059204101562</span></span>
<span id="cb130-64"><a href="#cb130-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         source: SMHI reanalysis run NORDIC-NS2_1d_20201201_20201201</span></span>
<span id="cb130-65"><a href="#cb130-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         file_quality_index: 1</span></span>
<span id="cb130-66"><a href="#cb130-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         creation_date: 2021-11-09 UTC</span></span>
<span id="cb130-67"><a href="#cb130-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         bullentin_date: 20201201</span></span>
<span id="cb130-68"><a href="#cb130-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         start_date: 2020-12-01 UTC</span></span>
<span id="cb130-69"><a href="#cb130-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         stop_date: 2020-12-01 UTC</span></span>
<span id="cb130-70"><a href="#cb130-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         start_time: 00:00 UTC</span></span>
<span id="cb130-71"><a href="#cb130-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         stop_time: 00:00 UTC</span></span>
<span id="cb130-72"><a href="#cb130-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         _CoordSysBuilder: ucar.nc2.dataset.conv.CF1Convention</span></span>
<span id="cb130-73"><a href="#cb130-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-74"><a href="#cb130-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Get longitude and latitude</span></span>
<span id="cb130-75"><a href="#cb130-75" aria-hidden="true" tabindex="-1"></a>lon <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(ncin,<span class="st">"longitude"</span>)</span>
<span id="cb130-76"><a href="#cb130-76" aria-hidden="true" tabindex="-1"></a>nlon <span class="ot">&lt;-</span> <span class="fu">dim</span>(lon)</span>
<span id="cb130-77"><a href="#cb130-77" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lon)</span>
<span id="cb130-78"><a href="#cb130-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 11.12484 11.18040 11.23596 11.29151 11.34706 11.40262</span></span>
<span id="cb130-79"><a href="#cb130-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-80"><a href="#cb130-80" aria-hidden="true" tabindex="-1"></a>lat <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(ncin,<span class="st">"latitude"</span>)</span>
<span id="cb130-81"><a href="#cb130-81" aria-hidden="true" tabindex="-1"></a>nlat <span class="ot">&lt;-</span> <span class="fu">dim</span>(lat)</span>
<span id="cb130-82"><a href="#cb130-82" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lat)</span>
<span id="cb130-83"><a href="#cb130-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 53.12496 53.15829 53.19162 53.22496 53.25829 53.29162</span></span>
<span id="cb130-84"><a href="#cb130-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-85"><a href="#cb130-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Get time</span></span>
<span id="cb130-86"><a href="#cb130-86" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(ncin,<span class="st">"time"</span>)</span>
<span id="cb130-87"><a href="#cb130-87" aria-hidden="true" tabindex="-1"></a>time</span>
<span id="cb130-88"><a href="#cb130-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   [1] 15751.0 15780.5 15811.0 15841.5 15872.0 15902.5 15933.5 15964.0 15994.5</span></span>
<span id="cb130-89"><a href="#cb130-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [10] 16025.0 16055.5 16086.5 16116.0 16145.5 16176.0 16206.5 16237.0 16267.5</span></span>
<span id="cb130-90"><a href="#cb130-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [19] 16298.5 16329.0 16359.5 16390.0 16420.5 16451.5 16481.0 16510.5 16541.0</span></span>
<span id="cb130-91"><a href="#cb130-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [28] 16571.5 16602.0 16632.5 16663.5 16694.0 16724.5 16755.0 16785.5 16816.5</span></span>
<span id="cb130-92"><a href="#cb130-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [37] 16846.5 16876.5 16907.0 16937.5 16968.0 16998.5 17029.5 17060.0 17090.5</span></span>
<span id="cb130-93"><a href="#cb130-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [46] 17121.0 17151.5 17182.5 17212.0 17241.5 17272.0 17302.5 17333.0 17363.5</span></span>
<span id="cb130-94"><a href="#cb130-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [55] 17394.5 17425.0 17455.5 17486.0 17516.5 17547.5 17577.0 17606.5 17637.0</span></span>
<span id="cb130-95"><a href="#cb130-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [64] 17667.5 17698.0 17728.5 17759.5 17790.0 17820.5 17851.0 17881.5 17912.5</span></span>
<span id="cb130-96"><a href="#cb130-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [73] 17942.0 17971.5 18002.0 18032.5 18063.0 18093.5 18124.5 18155.0 18185.5</span></span>
<span id="cb130-97"><a href="#cb130-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [82] 18216.0 18246.5 18277.5 18307.5 18337.5 18368.0 18398.5 18429.0 18459.5</span></span>
<span id="cb130-98"><a href="#cb130-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [91] 18490.5 18521.0 18551.5 18582.0 18612.5 18643.5 18673.0 18702.5 18733.0</span></span>
<span id="cb130-99"><a href="#cb130-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [100] 18763.5 18794.0 18824.5 18855.5 18886.0 18916.5 18947.0 18977.5 19008.5</span></span>
<span id="cb130-100"><a href="#cb130-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [109] 19038.0 19067.5 19098.0 19128.5 19159.0 19189.5 19220.5 19251.0 19281.5</span></span>
<span id="cb130-101"><a href="#cb130-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [118] 19312.0 19342.5 19373.5 19403.0 19432.5 19463.0 19493.5 19524.0 19554.5</span></span>
<span id="cb130-102"><a href="#cb130-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [127] 19585.5 19616.0 19646.5 19677.0 19707.5 19738.5 19768.5 19798.5 19829.0</span></span>
<span id="cb130-103"><a href="#cb130-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [136] 19859.5 19890.0 19920.5 19951.5 19982.0 20012.5 20043.0 20073.5 20104.5</span></span>
<span id="cb130-104"><a href="#cb130-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [145] 20134.0 20163.5 20194.0 20224.5 20255.0 20285.5 20316.5 20347.0 20377.5</span></span>
<span id="cb130-105"><a href="#cb130-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [154] 20408.0 20438.5 20469.5 20499.0 20528.5 20559.0 20589.5 20620.0 20650.5</span></span>
<span id="cb130-106"><a href="#cb130-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [163] 20681.5 20712.0 20742.5 20773.0 20803.5 20834.5 20864.0 20893.5 20924.0</span></span>
<span id="cb130-107"><a href="#cb130-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [172] 20954.5 20985.0 21015.5 21046.5 21077.0 21107.5 21138.0 21168.5 21199.5</span></span>
<span id="cb130-108"><a href="#cb130-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [181] 21229.5 21259.5 21290.0 21320.5 21351.0 21381.5 21412.5 21443.0 21473.5</span></span>
<span id="cb130-109"><a href="#cb130-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [190] 21504.0 21534.5 21565.5 21595.0 21624.5 21655.0 21685.5 21716.0 21746.5</span></span>
<span id="cb130-110"><a href="#cb130-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [199] 21777.5 21808.0 21838.5 21869.0 21899.5 21930.5 21960.0 21989.5 22020.0</span></span>
<span id="cb130-111"><a href="#cb130-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [208] 22050.5 22081.0 22111.5 22142.5 22173.0 22203.5 22234.0 22264.5 22295.5</span></span>
<span id="cb130-112"><a href="#cb130-112" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [217] 22325.0 22354.5 22385.0 22415.5 22446.0 22476.5 22507.5 22538.0 22568.5</span></span>
<span id="cb130-113"><a href="#cb130-113" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [226] 22599.0 22629.5 22660.5 22690.5 22720.5 22751.0 22781.5 22812.0 22842.5</span></span>
<span id="cb130-114"><a href="#cb130-114" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [235] 22873.5 22904.0 22934.5 22965.0 22995.5 23026.5 23056.0 23085.5 23116.0</span></span>
<span id="cb130-115"><a href="#cb130-115" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [244] 23146.5 23177.0 23207.5 23238.5 23269.0 23299.5 23330.0 23360.5 23391.5</span></span>
<span id="cb130-116"><a href="#cb130-116" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [253] 23421.0 23450.5 23481.0 23511.5 23542.0 23572.5 23603.5 23634.0 23664.5</span></span>
<span id="cb130-117"><a href="#cb130-117" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [262] 23695.0 23725.5 23756.5 23786.0 23815.5 23846.0 23876.5 23907.0 23937.5</span></span>
<span id="cb130-118"><a href="#cb130-118" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [271] 23968.5 23999.0 24029.5 24060.0 24090.5 24121.5 24151.5 24181.5 24212.0</span></span>
<span id="cb130-119"><a href="#cb130-119" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [280] 24242.5 24273.0 24303.5 24334.5 24365.0 24395.5 24426.0 24456.5 24487.5</span></span>
<span id="cb130-120"><a href="#cb130-120" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [289] 24517.0 24546.5 24577.0 24607.5 24638.0 24668.5 24699.5 24730.0 24760.5</span></span>
<span id="cb130-121"><a href="#cb130-121" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [298] 24791.0 24821.5 24852.5 24882.0 24911.5 24942.0 24972.5 25003.0 25033.5</span></span>
<span id="cb130-122"><a href="#cb130-122" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [307] 25064.5 25095.0 25125.5 25156.0 25186.5 25217.5 25247.0 25276.5 25307.0</span></span>
<span id="cb130-123"><a href="#cb130-123" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [316] 25337.5 25368.0 25398.5 25429.5 25460.0 25490.5 25521.0 25551.5 25582.5</span></span>
<span id="cb130-124"><a href="#cb130-124" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [325] 25612.5 25642.5 25673.0 25703.5 25734.0 25764.5 25795.5 25826.0 25856.5</span></span>
<span id="cb130-125"><a href="#cb130-125" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [334] 25887.0 25917.5</span></span>
<span id="cb130-126"><a href="#cb130-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-127"><a href="#cb130-127" aria-hidden="true" tabindex="-1"></a>tunits <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,<span class="st">"time"</span>,<span class="st">"units"</span>)</span>
<span id="cb130-128"><a href="#cb130-128" aria-hidden="true" tabindex="-1"></a>nt <span class="ot">&lt;-</span> <span class="fu">dim</span>(time)</span>
<span id="cb130-129"><a href="#cb130-129" aria-hidden="true" tabindex="-1"></a>nt</span>
<span id="cb130-130"><a href="#cb130-130" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 335</span></span>
<span id="cb130-131"><a href="#cb130-131" aria-hidden="true" tabindex="-1"></a>tunits</span>
<span id="cb130-132"><a href="#cb130-132" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $hasatt</span></span>
<span id="cb130-133"><a href="#cb130-133" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb130-134"><a href="#cb130-134" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb130-135"><a href="#cb130-135" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $value</span></span>
<span id="cb130-136"><a href="#cb130-136" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] "days since 1950-01-01 00:00:00"</span></span>
<span id="cb130-137"><a href="#cb130-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-138"><a href="#cb130-138" aria-hidden="true" tabindex="-1"></a><span class="co"># Get Salinity</span></span>
<span id="cb130-139"><a href="#cb130-139" aria-hidden="true" tabindex="-1"></a>dname <span class="ot">&lt;-</span> <span class="st">"sob"</span></span>
<span id="cb130-140"><a href="#cb130-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-141"><a href="#cb130-141" aria-hidden="true" tabindex="-1"></a>sal_array <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(ncin,dname)</span>
<span id="cb130-142"><a href="#cb130-142" aria-hidden="true" tabindex="-1"></a>dlname <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,dname,<span class="st">"long_name"</span>)</span>
<span id="cb130-143"><a href="#cb130-143" aria-hidden="true" tabindex="-1"></a>dunits <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,dname,<span class="st">"units"</span>)</span>
<span id="cb130-144"><a href="#cb130-144" aria-hidden="true" tabindex="-1"></a>fillvalue <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,dname,<span class="st">"_FillValue"</span>)</span>
<span id="cb130-145"><a href="#cb130-145" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(sal_array)</span>
<span id="cb130-146"><a href="#cb130-146" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 199 187 335</span></span>
<span id="cb130-147"><a href="#cb130-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-148"><a href="#cb130-148" aria-hidden="true" tabindex="-1"></a><span class="co"># Get global attributes</span></span>
<span id="cb130-149"><a href="#cb130-149" aria-hidden="true" tabindex="-1"></a>title <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,<span class="dv">0</span>,<span class="st">"title"</span>)</span>
<span id="cb130-150"><a href="#cb130-150" aria-hidden="true" tabindex="-1"></a>institution <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,<span class="dv">0</span>,<span class="st">"institution"</span>)</span>
<span id="cb130-151"><a href="#cb130-151" aria-hidden="true" tabindex="-1"></a>datasource <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,<span class="dv">0</span>,<span class="st">"source"</span>)</span>
<span id="cb130-152"><a href="#cb130-152" aria-hidden="true" tabindex="-1"></a>references <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,<span class="dv">0</span>,<span class="st">"references"</span>)</span>
<span id="cb130-153"><a href="#cb130-153" aria-hidden="true" tabindex="-1"></a>history <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,<span class="dv">0</span>,<span class="st">"history"</span>)</span>
<span id="cb130-154"><a href="#cb130-154" aria-hidden="true" tabindex="-1"></a>Conventions <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(ncin,<span class="dv">0</span>,<span class="st">"Conventions"</span>)</span>
<span id="cb130-155"><a href="#cb130-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-156"><a href="#cb130-156" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert time: split the time units string into fields</span></span>
<span id="cb130-157"><a href="#cb130-157" aria-hidden="true" tabindex="-1"></a>tustr <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(tunits<span class="sc">$</span>value, <span class="st">" "</span>)</span>
<span id="cb130-158"><a href="#cb130-158" aria-hidden="true" tabindex="-1"></a>tdstr <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(<span class="fu">unlist</span>(tustr)[<span class="dv">3</span>], <span class="st">"-"</span>)</span>
<span id="cb130-159"><a href="#cb130-159" aria-hidden="true" tabindex="-1"></a>tmonth <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">unlist</span>(tdstr)[<span class="dv">2</span>])</span>
<span id="cb130-160"><a href="#cb130-160" aria-hidden="true" tabindex="-1"></a>tday <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">unlist</span>(tdstr)[<span class="dv">3</span>])</span>
<span id="cb130-161"><a href="#cb130-161" aria-hidden="true" tabindex="-1"></a>tyear <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">unlist</span>(tdstr)[<span class="dv">1</span>])</span>
<span id="cb130-162"><a href="#cb130-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-163"><a href="#cb130-163" aria-hidden="true" tabindex="-1"></a><span class="co"># Here I deviate from the guide a little bit. Save this info:</span></span>
<span id="cb130-164"><a href="#cb130-164" aria-hidden="true" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">chron</span>(time, <span class="at">origin =</span> <span class="fu">c</span>(tmonth, tday, tyear))</span>
<span id="cb130-165"><a href="#cb130-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-166"><a href="#cb130-166" aria-hidden="true" tabindex="-1"></a><span class="co"># Crop the date variable</span></span>
<span id="cb130-167"><a href="#cb130-167" aria-hidden="true" tabindex="-1"></a>months <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(dates, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb130-168"><a href="#cb130-168" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(dates, <span class="dv">8</span>, <span class="dv">9</span>))</span>
<span id="cb130-169"><a href="#cb130-169" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(years <span class="sc">&gt;</span> <span class="dv">90</span>, <span class="dv">1900</span> <span class="sc">+</span> years, <span class="dv">2000</span> <span class="sc">+</span> years)</span>
<span id="cb130-170"><a href="#cb130-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-171"><a href="#cb130-171" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace netCDF fill values with NA's</span></span>
<span id="cb130-172"><a href="#cb130-172" aria-hidden="true" tabindex="-1"></a>sal_array[sal_array <span class="sc">==</span> fillvalue<span class="sc">$</span>value] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb130-173"><a href="#cb130-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-174"><a href="#cb130-174" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through all "dates", put into a list </span></span>
<span id="cb130-175"><a href="#cb130-175" aria-hidden="true" tabindex="-1"></a>dlist <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb130-176"><a href="#cb130-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-177"><a href="#cb130-177" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(months)) {</span>
<span id="cb130-178"><a href="#cb130-178" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-179"><a href="#cb130-179" aria-hidden="true" tabindex="-1"></a>  sal_sub <span class="ot">&lt;-</span> sal_array[, , i]</span>
<span id="cb130-180"><a href="#cb130-180" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-181"><a href="#cb130-181" aria-hidden="true" tabindex="-1"></a>  dlist[[i]] <span class="ot">&lt;-</span> sal_sub</span>
<span id="cb130-182"><a href="#cb130-182" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-183"><a href="#cb130-183" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb130-184"><a href="#cb130-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-185"><a href="#cb130-185" aria-hidden="true" tabindex="-1"></a><span class="co"># Name the list</span></span>
<span id="cb130-186"><a href="#cb130-186" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dlist) <span class="ot">&lt;-</span> <span class="fu">paste</span>(months, years, <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb130-187"><a href="#cb130-187" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dlist)</span>
<span id="cb130-188"><a href="#cb130-188" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; List of 335</span></span>
<span id="cb130-189"><a href="#cb130-189" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_1993 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-190"><a href="#cb130-190" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_1993 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-191"><a href="#cb130-191" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_1993 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-192"><a href="#cb130-192" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_1993 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-193"><a href="#cb130-193" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_1993 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-194"><a href="#cb130-194" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_1993 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-195"><a href="#cb130-195" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_1993 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-196"><a href="#cb130-196" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_1993 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-197"><a href="#cb130-197" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_1993: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-198"><a href="#cb130-198" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_1993: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-199"><a href="#cb130-199" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_1993: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-200"><a href="#cb130-200" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_1994 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-201"><a href="#cb130-201" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_1994 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-202"><a href="#cb130-202" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_1994 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-203"><a href="#cb130-203" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_1994 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-204"><a href="#cb130-204" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_1994 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-205"><a href="#cb130-205" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_1994 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-206"><a href="#cb130-206" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_1994 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-207"><a href="#cb130-207" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_1994 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-208"><a href="#cb130-208" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_1994 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-209"><a href="#cb130-209" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_1994: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-210"><a href="#cb130-210" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_1994: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-211"><a href="#cb130-211" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_1994: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-212"><a href="#cb130-212" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_1995 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-213"><a href="#cb130-213" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_1995 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-214"><a href="#cb130-214" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_1995 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-215"><a href="#cb130-215" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_1995 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-216"><a href="#cb130-216" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_1995 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-217"><a href="#cb130-217" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_1995 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-218"><a href="#cb130-218" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_1995 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-219"><a href="#cb130-219" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_1995 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-220"><a href="#cb130-220" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_1995 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-221"><a href="#cb130-221" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_1995: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-222"><a href="#cb130-222" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_1995: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-223"><a href="#cb130-223" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_1995: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-224"><a href="#cb130-224" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_1996 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-225"><a href="#cb130-225" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_1996 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-226"><a href="#cb130-226" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_1996 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-227"><a href="#cb130-227" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_1996 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-228"><a href="#cb130-228" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_1996 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-229"><a href="#cb130-229" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_1996 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-230"><a href="#cb130-230" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_1996 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-231"><a href="#cb130-231" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_1996 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-232"><a href="#cb130-232" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_1996 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-233"><a href="#cb130-233" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_1996: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-234"><a href="#cb130-234" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_1996: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-235"><a href="#cb130-235" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_1996: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-236"><a href="#cb130-236" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_1997 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-237"><a href="#cb130-237" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_1997 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-238"><a href="#cb130-238" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_1997 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-239"><a href="#cb130-239" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_1997 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-240"><a href="#cb130-240" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_1997 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-241"><a href="#cb130-241" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_1997 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-242"><a href="#cb130-242" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_1997 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-243"><a href="#cb130-243" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_1997 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-244"><a href="#cb130-244" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_1997 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-245"><a href="#cb130-245" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_1997: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-246"><a href="#cb130-246" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_1997: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-247"><a href="#cb130-247" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_1997: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-248"><a href="#cb130-248" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_1998 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-249"><a href="#cb130-249" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_1998 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-250"><a href="#cb130-250" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_1998 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-251"><a href="#cb130-251" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_1998 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-252"><a href="#cb130-252" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_1998 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-253"><a href="#cb130-253" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_1998 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-254"><a href="#cb130-254" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_1998 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-255"><a href="#cb130-255" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_1998 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-256"><a href="#cb130-256" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_1998 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-257"><a href="#cb130-257" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_1998: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-258"><a href="#cb130-258" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_1998: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-259"><a href="#cb130-259" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_1998: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-260"><a href="#cb130-260" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_1999 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-261"><a href="#cb130-261" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_1999 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-262"><a href="#cb130-262" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_1999 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-263"><a href="#cb130-263" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_1999 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-264"><a href="#cb130-264" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_1999 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-265"><a href="#cb130-265" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_1999 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-266"><a href="#cb130-266" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_1999 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-267"><a href="#cb130-267" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_1999 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-268"><a href="#cb130-268" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_1999 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-269"><a href="#cb130-269" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_1999: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-270"><a href="#cb130-270" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_1999: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-271"><a href="#cb130-271" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_1999: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-272"><a href="#cb130-272" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_2000 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-273"><a href="#cb130-273" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_2000 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-274"><a href="#cb130-274" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_2000 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-275"><a href="#cb130-275" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_2000 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-276"><a href="#cb130-276" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5_2000 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-277"><a href="#cb130-277" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6_2000 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-278"><a href="#cb130-278" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7_2000 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-279"><a href="#cb130-279" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8_2000 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-280"><a href="#cb130-280" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9_2000 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-281"><a href="#cb130-281" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10_2000: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-282"><a href="#cb130-282" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11_2000: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-283"><a href="#cb130-283" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12_2000: num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-284"><a href="#cb130-284" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1_2001 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-285"><a href="#cb130-285" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2_2001 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-286"><a href="#cb130-286" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3_2001 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-287"><a href="#cb130-287" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4_2001 : num [1:199, 1:187] NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ...</span></span>
<span id="cb130-288"><a href="#cb130-288" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   [list output truncated]</span></span>
<span id="cb130-289"><a href="#cb130-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-290"><a href="#cb130-290" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data holding object</span></span>
<span id="cb130-291"><a href="#cb130-291" aria-hidden="true" tabindex="-1"></a>sal_data_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb130-292"><a href="#cb130-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-293"><a href="#cb130-293" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each month_year and extract raster values for the cpue data points</span></span>
<span id="cb130-294"><a href="#cb130-294" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">unique</span>(dat<span class="sc">$</span>month_year)) { <span class="co"># We can use q1 as looping index, doesn't matter!</span></span>
<span id="cb130-295"><a href="#cb130-295" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-296"><a href="#cb130-296" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set plot limits</span></span>
<span id="cb130-297"><a href="#cb130-297" aria-hidden="true" tabindex="-1"></a>  ymin <span class="ot">=</span> <span class="dv">54</span>; ymax <span class="ot">=</span> <span class="dv">58</span>; xmin <span class="ot">=</span> <span class="dv">12</span>; xmax <span class="ot">=</span> <span class="dv">22</span></span>
<span id="cb130-298"><a href="#cb130-298" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-299"><a href="#cb130-299" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset a month-year combination</span></span>
<span id="cb130-300"><a href="#cb130-300" aria-hidden="true" tabindex="-1"></a>  sal_slice <span class="ot">&lt;-</span> dlist[[i]]</span>
<span id="cb130-301"><a href="#cb130-301" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-302"><a href="#cb130-302" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create raster for that year (i)</span></span>
<span id="cb130-303"><a href="#cb130-303" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="fu">t</span>(sal_slice), <span class="at">xmn =</span> <span class="fu">min</span>(lon), <span class="at">xmx =</span> <span class="fu">max</span>(lon), <span class="at">ymn =</span> <span class="fu">min</span>(lat), <span class="at">ymx =</span> <span class="fu">max</span>(lat),</span>
<span id="cb130-304"><a href="#cb130-304" aria-hidden="true" tabindex="-1"></a>              <span class="at">crs =</span> <span class="fu">CRS</span>(<span class="st">"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs+ towgs84=0,0,0"</span>))</span>
<span id="cb130-305"><a href="#cb130-305" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-306"><a href="#cb130-306" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Flip...</span></span>
<span id="cb130-307"><a href="#cb130-307" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">flip</span>(r, <span class="at">direction =</span> <span class="st">'y'</span>)</span>
<span id="cb130-308"><a href="#cb130-308" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-309"><a href="#cb130-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(r, <span class="at">main =</span> <span class="fu">paste</span>(i), <span class="at">ylim =</span> <span class="fu">c</span>(ymin, ymax), <span class="at">xlim =</span> <span class="fu">c</span>(xmin, xmax))</span>
<span id="cb130-310"><a href="#cb130-310" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-311"><a href="#cb130-311" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter the same year (i) in the cpue data and select only coordinates</span></span>
<span id="cb130-312"><a href="#cb130-312" aria-hidden="true" tabindex="-1"></a>  d_slice <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(month_year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(lon, lat)</span>
<span id="cb130-313"><a href="#cb130-313" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-314"><a href="#cb130-314" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make into a SpatialPoints object</span></span>
<span id="cb130-315"><a href="#cb130-315" aria-hidden="true" tabindex="-1"></a>  data_sp <span class="ot">&lt;-</span> <span class="fu">SpatialPoints</span>(d_slice)</span>
<span id="cb130-316"><a href="#cb130-316" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-317"><a href="#cb130-317" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract raster value (oxygen)</span></span>
<span id="cb130-318"><a href="#cb130-318" aria-hidden="true" tabindex="-1"></a>  rasValue <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">extract</span>(r, data_sp)</span>
<span id="cb130-319"><a href="#cb130-319" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-320"><a href="#cb130-320" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Now we want to plot the results of the raster extractions by plotting the cpue data points over a raster and saving it for each year.</span></span>
<span id="cb130-321"><a href="#cb130-321" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make the SpatialPoints object into a raster again (for plot)</span></span>
<span id="cb130-322"><a href="#cb130-322" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data_sp)</span>
<span id="cb130-323"><a href="#cb130-323" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-324"><a href="#cb130-324" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add in the raster value in the df holding the coordinates for the cpue data</span></span>
<span id="cb130-325"><a href="#cb130-325" aria-hidden="true" tabindex="-1"></a>  d_slice<span class="sc">$</span>sal <span class="ot">&lt;-</span> rasValue</span>
<span id="cb130-326"><a href="#cb130-326" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-327"><a href="#cb130-327" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add in which year</span></span>
<span id="cb130-328"><a href="#cb130-328" aria-hidden="true" tabindex="-1"></a>  d_slice<span class="sc">$</span>month_year <span class="ot">&lt;-</span> i</span>
<span id="cb130-329"><a href="#cb130-329" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-330"><a href="#cb130-330" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add each years' data in the list</span></span>
<span id="cb130-331"><a href="#cb130-331" aria-hidden="true" tabindex="-1"></a>  sal_data_list[[i]] <span class="ot">&lt;-</span> d_slice</span>
<span id="cb130-332"><a href="#cb130-332" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-333"><a href="#cb130-333" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb130-334"><a href="#cb130-334" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-15.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-16.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-17.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-18.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-19.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-20.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-21.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-22.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-23.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-24.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-25.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-26.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-27.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-28.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-29.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-30.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-31.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-32.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-33.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-34.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-35.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-36.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-37.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-38.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-39.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-40.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-41.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-42.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-43.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-44.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-45.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-46.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-47.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-48.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-49.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-50.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-51.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-52.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-53.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-54.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-55.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; filter: removed 898,535 rows (98%), 16,337 rows remaining</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/unnamed-chunk-6-56.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Now create a data frame from the list of all annual values</span></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>big_dat_sal <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(sal_data_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>env_dat <span class="ot">&lt;-</span> <span class="fu">left_join</span>(big_dat_oxy, big_dat_temp, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"month_year"</span>, <span class="st">"lon"</span>, <span class="st">"lat"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(big_dat_sal, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"month_year"</span>, <span class="st">"lon"</span>, <span class="st">"lat"</span>))</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; left_join: added one column (temp)</span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &gt; rows only in x         0</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &gt; rows only in y  (      0)</span></span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &gt; matched rows     914,872</span></span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &gt;                 =========</span></span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &gt; rows total       914,872</span></span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; left_join: added one column (sal)</span></span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &gt; rows only in x         0</span></span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &gt; rows only in y  (      0)</span></span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &gt; matched rows     914,872</span></span>
<span id="cb187-13"><a href="#cb187-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &gt;                 =========</span></span>
<span id="cb187-14"><a href="#cb187-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &gt; rows total       914,872</span></span>
<span id="cb187-15"><a href="#cb187-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-16"><a href="#cb187-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Now join these data with the full_dat</span></span>
<span id="cb187-17"><a href="#cb187-17" aria-hidden="true" tabindex="-1"></a>dat_full <span class="ot">&lt;-</span> <span class="fu">left_join</span>(dat, env_dat, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"month_year"</span>, <span class="st">"lon"</span>, <span class="st">"lat"</span>))</span>
<span id="cb187-18"><a href="#cb187-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; left_join: added 3 columns (oxy, temp, sal)</span></span>
<span id="cb187-19"><a href="#cb187-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &gt; rows only in x         0</span></span>
<span id="cb187-20"><a href="#cb187-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &gt; rows only in y  (      0)</span></span>
<span id="cb187-21"><a href="#cb187-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &gt; matched rows     914,872</span></span>
<span id="cb187-22"><a href="#cb187-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &gt;                 =========</span></span>
<span id="cb187-23"><a href="#cb187-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &gt; rows total       914,872</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="add-ices-areas" class="level2">
<h2 class="anchored" data-anchor-id="add-ices-areas">Add ICES areas</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stackoverflow.com/questions/34272309/extract-shapefile-value-to-point-with-r</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="co"># https://gis.ices.dk/sf/</span></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>shape <span class="ot">&lt;-</span> <span class="fu">shapefile</span>(<span class="st">"data/ICES_StatRec_mapto_ICES_Areas/StatRec_map_Areas_Full_20170124.shp"</span>)</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(shape)</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   OBJECTID ID ICESNAME SOUTH WEST NORTH EAST AREA_KM2 stat_x stat_y Area_27</span></span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        1 47     47A0  59.0  -44  59.5  -43     3178  -43.5  59.25  14.b.2</span></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        2 48     48A0  59.5  -44  60.0  -43     3132  -43.5  59.75  14.b.2</span></span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        3 49     49A0  60.0  -44  60.5  -43     3085  -43.5  60.25  14.b.2</span></span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        4 50     50A0  60.5  -44  61.0  -43     3038  -43.5  60.75  14.b.2</span></span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        5 51     51A0  61.0  -44  61.5  -43     2991  -43.5  61.25  14.b.2</span></span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        6 52     52A0  61.5  -44  62.0  -43     2944  -43.5  61.75  14.b.2</span></span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Perc      MaxPer RNDMaxPer AreasList Shape_Leng Shape_Area</span></span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 100.00000000 100.0000000       100    14.b.2          3        0.5</span></span>
<span id="cb188-14"><a href="#cb188-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  84.12674145  84.1267414        84    14.b.2          3        0.5</span></span>
<span id="cb188-15"><a href="#cb188-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  24.99803694  24.9980369        25    14.b.2          3        0.5</span></span>
<span id="cb188-16"><a href="#cb188-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  11.97744244  11.9774424        12    14.b.2          3        0.5</span></span>
<span id="cb188-17"><a href="#cb188-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   3.89717625   3.8971762         4    14.b.2          3        0.5</span></span>
<span id="cb188-18"><a href="#cb188-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6   0.28578428   0.2857843         0    14.b.2          3        0.5</span></span>
<span id="cb188-19"><a href="#cb188-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-20"><a href="#cb188-20" aria-hidden="true" tabindex="-1"></a>pts <span class="ot">&lt;-</span> <span class="fu">SpatialPoints</span>(<span class="fu">cbind</span>(dat_full<span class="sc">$</span>lon, dat_full<span class="sc">$</span>lat), </span>
<span id="cb188-21"><a href="#cb188-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">proj4string =</span> <span class="fu">CRS</span>(<span class="fu">proj4string</span>(shape)))</span>
<span id="cb188-22"><a href="#cb188-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-23"><a href="#cb188-23" aria-hidden="true" tabindex="-1"></a>dat_full<span class="sc">$</span>subdiv <span class="ot">&lt;-</span> <span class="fu">over</span>(pts, shape)<span class="sc">$</span>Area_27</span>
<span id="cb188-24"><a href="#cb188-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-25"><a href="#cb188-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename subdivisions to the more common names and do some more filtering (by sub div and area)</span></span>
<span id="cb188-26"><a href="#cb188-26" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">unique</span>(dat_full<span class="sc">$</span>subdiv))</span>
<span id="cb188-27"><a href="#cb188-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] "3.d.24"   "3.d.25"   "3.d.26"   "3.d.27"   "3.d.28.2"</span></span>
<span id="cb188-28"><a href="#cb188-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-29"><a href="#cb188-29" aria-hidden="true" tabindex="-1"></a>dat_full <span class="ot">&lt;-</span> dat_full <span class="sc">|&gt;</span> </span>
<span id="cb188-30"><a href="#cb188-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sub_div =</span> <span class="fu">factor</span>(subdiv),</span>
<span id="cb188-31"><a href="#cb188-31" aria-hidden="true" tabindex="-1"></a>         <span class="at">sub_div =</span> <span class="fu">fct_recode</span>(subdiv,</span>
<span id="cb188-32"><a href="#cb188-32" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"24"</span> <span class="ot">=</span> <span class="st">"3.d.24"</span>,</span>
<span id="cb188-33"><a href="#cb188-33" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"25"</span> <span class="ot">=</span> <span class="st">"3.d.25"</span>,</span>
<span id="cb188-34"><a href="#cb188-34" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"26"</span> <span class="ot">=</span> <span class="st">"3.d.26"</span>,</span>
<span id="cb188-35"><a href="#cb188-35" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"27"</span> <span class="ot">=</span> <span class="st">"3.d.27"</span>,</span>
<span id="cb188-36"><a href="#cb188-36" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"28"</span> <span class="ot">=</span> <span class="st">"3.d.28.1"</span>,</span>
<span id="cb188-37"><a href="#cb188-37" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"28"</span> <span class="ot">=</span> <span class="st">"3.d.28.2"</span>,</span>
<span id="cb188-38"><a href="#cb188-38" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"29"</span> <span class="ot">=</span> <span class="st">"3.d.29"</span>),</span>
<span id="cb188-39"><a href="#cb188-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">sub_div =</span> <span class="fu">as.character</span>(sub_div)) <span class="sc">|&gt;</span> </span>
<span id="cb188-40"><a href="#cb188-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sub_div <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"24"</span>, <span class="st">"25"</span>, <span class="st">"26"</span>, <span class="st">"27"</span>, <span class="st">"28"</span>, <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb188-41"><a href="#cb188-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(lat <span class="sc">&gt;</span> <span class="dv">54</span> <span class="sc">&amp;</span> lat <span class="sc">&lt;</span> <span class="dv">59</span> <span class="sc">&amp;</span> lon <span class="sc">&lt;</span> <span class="dv">22</span>)</span>
<span id="cb188-42"><a href="#cb188-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: There was 1 warning in `.fun()`.</span></span>
<span id="cb188-43"><a href="#cb188-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ℹ In argument: `sub_div = fct_recode(...)`.</span></span>
<span id="cb188-44"><a href="#cb188-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Caused by warning:</span></span>
<span id="cb188-45"><a href="#cb188-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ! Unknown levels in `f`: 3.d.28.1, 3.d.29</span></span>
<span id="cb188-46"><a href="#cb188-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mutate: new variable 'sub_div' (character) with 5 unique values and 0% NA</span></span>
<span id="cb188-47"><a href="#cb188-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; filter: no rows removed</span></span>
<span id="cb188-48"><a href="#cb188-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; filter: no rows removed</span></span>
<span id="cb188-49"><a href="#cb188-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-50"><a href="#cb188-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Add ICES rectangles</span></span>
<span id="cb188-51"><a href="#cb188-51" aria-hidden="true" tabindex="-1"></a>dat_full<span class="sc">$</span>ices_rect <span class="ot">&lt;-</span> mapplots<span class="sc">::</span><span class="fu">ices.rect2</span>(<span class="at">lon =</span> dat_full<span class="sc">$</span>lon, <span class="at">lat =</span> dat_full<span class="sc">$</span>lat)</span>
<span id="cb188-52"><a href="#cb188-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-53"><a href="#cb188-53" aria-hidden="true" tabindex="-1"></a>plot_map <span class="sc">+</span></span>
<span id="cb188-54"><a href="#cb188-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="at">data =</span> <span class="fu">filter</span>(dat_full, year <span class="sc">==</span> <span class="dv">1999</span>), <span class="fu">aes</span>(X<span class="sc">*</span><span class="dv">1000</span>, Y<span class="sc">*</span><span class="dv">1000</span>, <span class="at">fill =</span> oxy)) <span class="sc">+</span></span>
<span id="cb188-55"><a href="#cb188-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>sub_div)</span>
<span id="cb188-56"><a href="#cb188-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; filter: removed 882,198 rows (96%), 32,674 rows remaining</span></span>
<span id="cb188-57"><a href="#cb188-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 1524 rows containing missing values (`geom_raster()`).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_make_pred_grid_files/figure-html/ices%20areas-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>dat_full <span class="ot">&lt;-</span> dat_full <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>subdiv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="save" class="level2">
<h2 class="anchored" data-anchor-id="save">Save</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove variables and save</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>pred_grid_93_06 <span class="ot">&lt;-</span> dat_full <span class="sc">|&gt;</span> <span class="fu">filter</span>(year <span class="sc">&lt;</span> <span class="dv">2007</span>)</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; filter: removed 457,436 rows (50%), 457,436 rows remaining</span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>pred_grid_07_19 <span class="ot">&lt;-</span> dat_full <span class="sc">|&gt;</span> <span class="fu">filter</span>(year <span class="sc">&gt;</span> <span class="dv">2006</span>)</span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; filter: removed 457,436 rows (50%), 457,436 rows remaining</span></span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(pred_grid_93_06, <span class="at">file =</span> <span class="st">"data/clean/pred_grid_(1_2).csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(pred_grid_07_19, <span class="at">file =</span> <span class="st">"data/clean/pred_grid_(2_2).csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>